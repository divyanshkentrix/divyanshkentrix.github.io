<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kentrix Analytics Dashboard - Location Analytics</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Leaflet CSS and JS for map functionality -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); min-height: 100vh; color: #0f172a; }
    .header { background: linear-gradient(135deg, #2a5b7f 0%, #1e4a6b 100%); box-shadow: 0 4px 20px rgba(62, 193, 189, 0.2); position: sticky; top: 0; z-index: 50; border-bottom: 2px solid #3ec1bd; }
    .header-content { max-width: 1280px; margin: 0 auto; padding: 1rem 1.5rem; display: flex; align-items: center; justify-content: space-between; flex-wrap: nowrap; gap: 2rem; }
    .logo-section { display: flex; align-items: center; gap: 0.5rem; }
    .store-title { color: #ffffff; font-size: 1.125rem; font-weight: 500; white-space: nowrap; }
    .location-filter { display: flex; align-items: center; gap: 1rem; }
    .location-filter select { padding: 0.5rem 1rem; border: 2px solid #3ec1bd; border-radius: 0.5rem; background: white; color: #2a5b7f; font-weight: 500; font-size: 0.875rem; cursor: pointer; }
    .location-filter label { color: #ffffff; font-weight: 500; }
    .store-info { text-align: right; }
    .store-name { font-size: 1.25rem; font-weight: bold; color: #ffffff; }
    .store-details { font-size: 0.75rem; color: #ffffff; }
    .container { max-width: 1280px; margin: 0 auto; padding: 2rem 1.5rem; }
    .dashboard-card { background: white; border-radius: 1rem; box-shadow: 0 10px 30px rgba(42, 91, 127, 0.15); margin-bottom: 2rem; border: 1px solid #e0f2fe; }
    .tabs { display: flex; overflow-x: auto; border-bottom: 2px solid #e0f2fe; background: #f8fafc; }
    .tab { padding: 1rem 1.5rem; font-weight: 600; white-space: nowrap; cursor: pointer; transition: all 0.3s; font-size: 0.875rem; color: #64748b; background: none; border: none; border-bottom: 3px solid transparent; }
    .tab:hover { background: rgba(62, 193, 189, 0.1); color: #2a5b7f; }
    .tab.active { border-bottom-color: #00ffff; background: rgba(0, 255, 255, 0.1); color: #2a5b7f; box-shadow: 0 0 15px rgba(0, 255, 255, 0.2); }
    .content { padding: 2rem; }
    .metrics-grid { display: flex; gap: 1rem; overflow-x: auto; margin-bottom: 2rem; }
    .metric-card { background: linear-gradient(135deg, #f0f9ff 0%, white 100%); border-radius: 0.75rem; box-shadow: 0 4px 15px rgba(42, 91, 127, 0.15); padding: 1.5rem; border-left: 4px solid #00ffff; flex: 1; min-width: 200px; max-width: 400px; transition: all 0.3s; border: 1px solid #bae6fd; }
    .metric-card:hover { box-shadow: 0 10px 25px rgba(0, 255, 255, 0.3); transform: translateY(-5px); }
    .metric-label { font-size: 0.75rem; font-weight: bold; color: #2a5b7f; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem; }
    
    .metric-label-total-poi { font-size: 0.75rem; font-weight: bold; color: #2a5b7f; letter-spacing: 0.1em; margin-bottom: 0.5rem; }
    .metric-value { font-size: 2rem; font-weight: bold; background: linear-gradient(135deg, #2a5b7f 0%, #3ec1bd 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; }
    .metric-desc { font-size: 0.875rem; color: #475569; }
    .insights-section { background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%); border-radius: 1rem; box-shadow: 0 10px 30px rgba(42, 91, 127, 0.1); padding: 2rem; margin-top: 2rem; border: 1px solid #bae6fd; }
    .insights-title { font-size: 1.5rem; font-weight: bold; color: #2a5b7f; margin-bottom: 1.5rem; display: flex; align-items: center; }
    .insights-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
    .insight-card { background: white; border-radius: 0.75rem; padding: 1.5rem; box-shadow: 0 4px 15px rgba(42, 91, 127, 0.1); border-left: 4px solid #3ec1bd; border: 1px solid #e0f2fe; transition: all 0.3s; }
    .insight-card:hover { box-shadow: 0 8px 25px rgba(62, 193, 189, 0.2); transform: translateY(-3px); }
    .insight-title { font-weight: bold; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem; display: flex; align-items: center; }
    .insight-text { color: #000000; font-size: 0.875rem; line-height: 1.6; }
    .insight-text p { margin-bottom: 0.75rem; }
    .insight-text strong { color: #2a5b7f; }
    .chart-container { margin: 2rem 0; background: #ffffff; padding: 1.5rem; border-radius: 1rem; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
    .section-title { font-size: 1.5rem; font-weight: bold; color: #2a5b7f; margin-bottom: 1.5rem; }
    .products-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1.5rem; }
    .product-card { background: #ffffff; border-radius: 1rem; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); padding: 1.5rem; transition: all 0.3s; }
    .product-card:hover { box-shadow: 0 15px 35px rgba(62, 193, 189, 0.3); transform: translateY(-5px); }
    .product-title { font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 0.875rem; }
    .product-legend { margin-top: 1rem; }
    .legend-item { display: flex; align-items: center; justify-content: space-between; font-size: 0.75rem; margin-bottom: 0.5rem; color: #2a5b7f; }
    .legend-label { display: flex; align-items: center; }
    .legend-color { width: 0.75rem; height: 0.75rem; border-radius: 50%; margin-right: 0.5rem; }
    .legend-value { font-weight: 600; color: #2a5b7f; }
    .breakdown-card { background: #ffffff; border-radius: 1rem; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); padding: 1.5rem; margin-top: 2rem; }
    .breakdown-item { display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: #ffffff; border-radius: 0.75rem; border-left: 4px solid #3ec1bd; margin-bottom: 0.75rem; transition: all 0.3s; border: 1px solid rgba(62, 193, 189, 0.2); }
    .breakdown-item:hover { background: #f0f9ff; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); }
    .breakdown-label { font-size: 0.875rem; font-weight: 500; color: #2a5b7f; }
    .breakdown-value { font-size: 1.25rem; font-weight: bold; color: #2a5b7f; }
    .footer { text-align: center; color: #3ec1bd; font-size: 0.875rem; margin-top: 2rem; padding-bottom: 1rem; }
    .no-data { text-align: center; color: #64748b; font-style: italic; padding: 2rem; }
    
    /* Map-specific styles */
    .map-container { background: white; border-radius: 1rem; padding: 1.5rem; box-shadow: 0 10px 30px rgba(42, 91, 127, 0.15); margin-bottom: 2rem; border: 1px solid #e0f2fe; }
    .map-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem; }
    .map-title { font-size: 1.5rem; font-weight: bold; color: #120d21; }
    .map-controls { display: flex; gap: 0.5rem; }
    .map-control-btn { padding: 0.5rem 1rem; border: none; border-radius: 20px; background: #3ec1bd; color: white; cursor: pointer; font-size: 0.875rem; transition: background 0.3s ease; font-weight: 500; }
    .map-control-btn:hover { background: #00ffff; }
    .map-control-btn.active { background: #2a5b7f; }
    #locationMap { 
        height: 500px; 
        border-radius: 10px; 
        border: 2px solid #e0f2fe; 
        position: relative;
        overflow: hidden;
    }
    .location-directory { display: grid; grid-template-columns: 2.5fr 0.75fr; gap: 2rem; margin-top: 2rem; }
    .locations-panel { background: white; border-radius: 1rem; padding: 1.5rem; box-shadow: 0 10px 30px rgba(42, 91, 127, 0.15); height: 607px; overflow-y: auto; border: 1px solid #e0f2fe; }
    .locations-panel h4 { font-size: 1.25rem; font-weight: 600; color: #120d21; margin-bottom: 1.5rem; border-bottom: 2px solid #3ec1bd; padding-bottom: 10px; }
    .location-item { padding: 1rem; border-bottom: 1px solid #eee; cursor: pointer; transition: background 0.3s ease; border-radius: 8px; margin-bottom: 5px; }
    .location-item:hover { background: #f8fafc; border-color: #3ec1bd; }
    .location-name { font-weight: 600; color: #120d21; font-size: 0.95rem; margin-bottom: 5px; }
    .location-coords { font-size: 0.8rem; color: #64748b; }
    .custom-popup { font-family: 'Segoe UI', sans-serif; }
    .popup-title { font-weight: 600; color: #2a5b7f; margin-bottom: 5px; }
    .popup-coords { font-size: 0.9rem; color: #64748b; }
    .leaflet-pane {z-index: 0 !important;}
    .leaflet-left {z-index: 0 !important;}
    .leaflet-control-attribution {display: none !important;}
    
    /* Competitor Styles */
    .competitor-toggle {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 1000;
        background: white;
        border: 2px solid #e11d48;
        border-radius: 6px;
        padding: 8px 12px;
        font-size: 12px;
        font-weight: bold;
        color: #e11d48;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        transition: all 0.3s;
        max-width: 160px;
        text-align: center;
        white-space: nowrap;
    }
    
    .competitor-toggle:hover {
        background: #fef2f2;
        transform: translateY(-1px);
    }
    
    .competitor-toggle.active {
        background: #e11d48;
        color: white;
        border-color: #be185d;
    }
    
    .gpkg-toggle {
        position: absolute;
        top: 50px;
        right: 10px;
        z-index: 1000;
        background: white;
        border: 2px solid #059669;
        border-radius: 6px;
        padding: 8px 12px;
        font-size: 12px;
        font-weight: bold;
        color: #059669;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        transition: all 0.3s;
        max-width: 160px;
        text-align: center;
        white-space: nowrap;
    }
    
    .gpkg-toggle:hover {
        background: #f0fdf4;
        transform: translateY(-1px);
    }
    
    .gpkg-toggle.active {
        background: #059669;
        color: white;
        border-color: #047857;
    }
    
    .competitors-legend {
        position: absolute;
        bottom: 10px;
        left: 10px;
        background: white;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        max-width: 280px;
        z-index: 1000;
        display: none;
        border: 2px solid #e5e7eb;
    }
    
    .competitors-legend h4 {
        color: #2a5b7f;
        margin: 0 0 12px 0;
        font-size: 14px;
        font-weight: bold;
    }
    
    .competitor-legend-item {
        display: flex;
        align-items: center;
        margin-bottom: 6px;
        font-size: 12px;
        color: #374151;
    }
    
    .competitor-marker {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        margin-right: 8px;
        flex-shrink: 0;
        border: 2px solid white;
        box-shadow: 0 1px 3px rgba(0,0,0,0.3);
    }
    
    @media (max-width: 1024px) { .location-directory { grid-template-columns: 1fr; } }
    @media (max-width: 768px) { 
        .map-header { flex-direction: column; gap: 15px; }
        
        /* Adjust button positioning on mobile */
        .competitor-toggle, .gpkg-toggle {
            font-size: 11px;
            padding: 6px 10px;
            max-width: 140px;
        }
        
        .competitor-toggle {
            top: 8px;
            right: 8px;
        }
        
        .gpkg-toggle {
            top: 45px;
            right: 8px;
        }
        
        .competitors-legend {
            max-width: 220px;
            font-size: 11px;
            padding: 10px;
        }
    }
    
    @media (max-width: 480px) {
        /* Stack buttons vertically on very small screens */
        .competitor-toggle, .gpkg-toggle {
            font-size: 10px;
            padding: 5px 8px;
            max-width: 120px;
        }
        
        .competitor-toggle {
            top: 5px;
            right: 5px;
        }
        
        .gpkg-toggle {
            top: 40px;
            right: 5px;
        }
    }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo-box">
                    <img src="https://kentrix.ai/wp-content/uploads/elementor/thumbs/Kentrix-New-Logo-White-rbw3byoacvoljlrvskr875ox9lkhq4af7o1akuoi68.png" width="200" height="40" alt="Kentrix Logo">
                </div>
                <div style="display: flex; flex-direction: column; line-height: 1.3;">
                    <p class="store-title">Analytics</p>
                    <p class="store-title">Dashboard</p>
                </div>
            </div>
            <div class="location-filter">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div class="filter-tabs" style="display: flex; border-radius: 0.5rem; overflow: hidden; border: 2px solid #3ec1bd;">
                        <button id="locationTab" class="filter-tab active" onclick="changeFilterType('location')" style="padding: 0.5rem 1rem; background: white; color: #3ec1bd; border: none; font-weight: 500; cursor: pointer; transition: all 0.3s;">Location Level</button>
                    </div>
                    <select id="locationSelect" onchange="updateLocation()" style="padding: 0.5rem 1rem; border: 2px solid #3ec1bd; border-radius: 0.5rem; background: white; color: #2a5b7f; font-weight: 500; font-size: 0.875rem; cursor: pointer; min-width: 200px;">
                        <option value="">Select a location...</option>
                    </select>
                </div>
            </div>            
            <div class="store-info">
                <div class="store-name" id="storeName">Kentrix Analytics</div>
                <div class="store-details" id="storeDetails">Select a location to view analytics</div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="dashboard-card">
            <div class="tabs">
                <button class="tab active" onclick="showTab('locations')">üó∫Ô∏è Store Locations</button>
                <button class="tab" onclick="showTab('overview')">üìä Overview & Insights</button>
                <button class="tab" onclick="showTab('income')">üí∞ Income Analysis</button>
                <button class="tab" onclick="showTab('lifestyle')">üë• Lifestyle Segments</button>
                <button class="tab" onclick="showTab('spending')">üí≥ Spending Patterns</button>
                <button class="tab" onclick="showTab('education')">üéì Education</button>
                <button class="tab" onclick="showTab('occupation')">üíº Occupation</button>
                <button class="tab" onclick="showTab('banking')">üè¶ Banking</button>
                <button class="tab" onclick="showTab('fmcg')">üß¥ FMCG</button>
                <button class="tab" onclick="showTab('fashion')">üëó Fashion</button>
                <button class="tab" onclick="showTab('jewellery')">üíç Jewellery</button>
                <button class="tab" onclick="showTab('realestate')">üè¢ Real Estate</button>
                <button class="tab" onclick="showTab('retail')">üõçÔ∏è Retail</button>
                <button class="tab" onclick="showTab('travel')">‚úàÔ∏è Travel</button>
                <button class="tab" onclick="showTab('twowheeler')">üèçÔ∏è Two Wheeler</button>
                <button class="tab" onclick="showTab('automobile')">üöó Automobile</button>
                <button class="tab" id="footfallTab" onclick="showTab('footfall')">üë• Footfall Analysis</button>
                <button class="tab" id="poiTab" onclick="showTab('poi')">üè¢ POI Deep Dive</button>
            </div>
            
            <div class="content">
                <div id="overview-tab" class="tab-content"  style="display: none;">
                    <h3 class="section-title">Store Overview & Key Metrics</h3>
                    <div class="metrics-grid" id="metricsGrid">
                        <div class="no-data">Select a location to view metrics</div>
                    </div>
                    <div class="insights-section" id="insightsSection" style="display: none;">
                        <h4 class="insights-title"><span style="font-size: 2rem; margin-right: 0.75rem;">üîç</span>Key Insights & Strategic Analysis</h4>
                        <div class="insights-grid" id="insightsGrid">
                        </div>
                    </div>
                </div>
                
                <div id="income-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Income Segment Analysis (Households by Monthly Income)</h3>
                    <div class="chart-container"><canvas id="incomeChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Income Segments Breakdown (Households by Monthly Income)</h4>
                        <div id="incomeBreakdown"></div>
                    </div>
                </div>
                
                <div id="lifestyle-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Lifestyle Segment Analysis (Population by Lifestyle Affinity)</h3>
                    <div class="chart-container"><canvas id="lifestyleChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Lifestyle Segments Breakdown (Population by Lifestyle Affinity)</h4>
                        <div id="lifestyleBreakdown"></div>
                    </div>
                </div>
                
                <div id="spending-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Spending Patterns Analysis (Monthly Household Level Average)</h3>
                    <div class="chart-container"><canvas id="spendingChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Spending Categories Breakdown (Monthly Household Level Average)</h4>
                        <div id="spendingBreakdown"></div>
                    </div>
                </div>
                
                <div id="education-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Education Analysis (Population by Education Level) </h3>
                    <div class="chart-container"><canvas id="educationChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Education Levels Breakdown (Population by Education Level)</h4>
                        <div id="educationBreakdown"></div>
                    </div>
                </div>
                
                <div id="occupation-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Occupation Analysis (Population by Occupational Categories)</h3>
                    <div class="chart-container"><canvas id="occupationChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Occupation Types Breakdown (Population by Occupational Categories)</h4>
                        <div id="occupationBreakdown"></div>
                    </div>
                </div>
                
                <div id="banking-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Banking Product Purchase Affinity (Households Level)</h3>
                    <div class="products-grid" id="bankingProducts"></div>
                </div>
                
                <div id="fmcg-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">FMCG Product Purchase Affinity (Households Level)</h3>
                    <div class="products-grid" id="fmcgProducts"></div>
                </div>
                
                <div id="fashion-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Fashion Product Purchase Affinity (Households Level)</h3>
                    <div class="chart-container"><canvas id="fashionChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Fashion Product Purchase Affinity Breakdown (Households Level)</h4>
                        <div id="fashionBreakdown"></div>
                    </div>
                </div>
                
                <div id="jewellery-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Jewellery Product Purchase Affinity (Households Level)</h3>
                    <div class="products-grid" id="jewelleryProducts"></div>
                </div>
                
                <div id="realestate-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Real Estate Purchase Affinity (Households Level)</h3>
                    <div class="chart-container"><canvas id="realestateChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Real Estate Purchase Affinity Breakdown (Households Level)</h4>
                        <div id="realestateBreakdown"></div>
                    </div>
                </div>
                
                <div id="retail-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Retail Product Purchase Affinity (Households Level)</h3>
                    <div class="products-grid" id="retailProducts"></div>
                </div>
                
                <div id="travel-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Travel Affinity (Households Level)</h3>
                    <div class="products-grid" id="travelProducts"></div>
                </div>
                
                <div id="twowheeler-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Two Wheeler Purchase Affinity (Households Level)</h3>
                    <div class="chart-container"><canvas id="twowheelerChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Two Wheeler Purchase Affinity Breakdown (Households Level)</h4>
                        <div id="twowheelerBreakdown"></div>
                    </div>
                </div>
                
                <div id="automobile-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Automobile Purchase Affinity (Households Level)</h3>
                    <div class="chart-container"><canvas id="automobileChart" height="100"></canvas></div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 2rem; font-size: 1.125rem;">Automobile Purchase Affinity Breakdown (Households Level)</h4>
                        <div id="automobileBreakdown"></div>
                    </div>
                </div>
                
                <div id="footfall-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Footfall Analysis</h3>
                    <div class="metrics-grid" id="footfallMetrics" style="margin-bottom: 2rem;">
                    </div>
                    <div class="chart-container">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Income Segment Analysis (Visitors (Index) by Monthly Income)</h4>
                        <canvas id="esiChart" height="100"></canvas>
                    </div>
                    <div class="chart-container">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Lifestyle Segment Analysis (Visitors (Index) by Lifestyle Affinity)</h4>
                        <canvas id="lsiChart" height="100"></canvas>
                    </div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Detailed Footfall Breakdown</h4>
                        <div id="footfallBreakdown"></div>
                    </div>
                </div>
                
                <div id="poi-tab" class="tab-content" style="display: none;">
                    <h3 class="section-title">Points of Interest (POI) Analysis</h3>
                    <div class="metrics-grid" id="poiMetrics" style="margin-bottom: 2rem;">
                    </div>
                    <div class="insights-section">
                        <h4 class="insights-title"><span style="font-size: 2rem; margin-right: 0.75rem;">üè¢</span>POI Categories Overview</h4>
                        <div class="insights-grid" id="poiCategoriesGrid">
                        </div>
                    </div>
                    <div class="breakdown-card">
                        <h4 style="font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1.125rem;">Detailed POI Breakdown by Category</h4>
                        <div id="poiBreakdown"></div>
                    </div>
                </div>
                
                <div id="locations-tab" class="tab-content">
                    <h3 class="section-title">Store Locations</h3>
                    
                    <div class="location-directory">
                        <div class="map-container" style="margin-bottom: 0;">
                            <div class="map-header">
                                <h4 class="map-title">üó∫Ô∏è Interactive Store Map</h4>
                                <div class="map-controls">
                                    <button class="map-control-btn active" id="satelliteBtn" onclick="switchMapLayer('satellite')">Satellite</button>
                                    <button class="map-control-btn" id="streetBtn" onclick="switchMapLayer('street')">Street</button>
                                </div>
                            </div>
                            <div style="position: relative;">
                                <div id="locationMap"></div>
                                <div class="competitor-toggle" id="competitorToggle" onclick="toggleCompetitors()">
                                    Show Competitors
                                </div>
                                <div class="gpkg-toggle" id="gpkgToggle" onclick="toggleGpkgLayer()">
                                    Show Catchments
                                </div>
                                <div class="competitors-legend" id="competitorsLegend">
                                    <h4>üè¢ Competitor Brands</h4>
                                    <div id="competitorLegendItems">
                                        <!-- Legend items will be populated by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="locations-panel">
                            <h4>üìç Store Directory (<span id="totalStores">0</span> Locations)</h4>
                            <div id="locationsList">
                                <!-- Store list will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <p style="font-weight: 500;">Kentrix Store Analytics Dashboard ‚Ä¢ Location-Based Analytics ‚Ä¢ Know Your Market</p>
        </div>
    </div>

    <script>
        let csvData = [];
        let currentLocationData = null;
        let charts = {};
        let filterType = 'location';
        
        // Map-related variables
        let map;
        let mapMarkers = [];
        let mapInitialized = false;
        
        const csvDataset = [
            {
                        "pincode": 1,
                        "Location ": "FreshX",
                        "latitude": 28.392022,
                        "longitude": 77.029832,
                        "total_number_of_population": 69772,
                        "catchment_households": 18495,
                        "avg_monthly_income": 161000,
                        "spend_housing": 45900,
                        "spend_food_fmcg": 31000,
                        "spend_apparel": 9900,
                        "spend_transportation": 9000,
                        "spend_healthcare_medical": 10300,
                        "spend_financial_savings": 24400,
                        "spend_education": 12000,
                        "spend_entertainment": 11000,
                        "spend_others": 7500,
                        "lsi_01": 39098,
                        "lsi_02": 0,
                        "lsi_03": 12098,
                        "lsi_04": 9798,
                        "lsi_05": 3662,
                        "lsi_06": 3530,
                        "lsi_07": 336,
                        "lsi_08": 409,
                        "lsi_09": 841,
                        "lsi_10": 0,
                        "lsi_11": 0,
                        "lsi_12": 0,
                        "hh_400k_to_inf": 1092,
                        "hh_300k_to_400k": 1159,
                        "hh_250k_to_300k": 324,
                        "hh_200k_to_250k": 649,
                        "hh_160_to_200k": 3141,
                        "hh_120k_to_160k": 3964,
                        "hh_80k_to_120k": 4700,
                        "hh_40k_to_80k": 3075,
                        "hh_20k_to_40k": 352,
                        "hh_0_to_20k": 39,
                        "hh_spend_housing_250k_to_inf": 0,
                        "hh_spend_housing_200k_to_250k": 0,
                        "hh_spend_housing_160k_to_200k": 0,
                        "hh_spend_housing_130k_to_160k": 626,
                        "hh_spend_housing_100k_to_130k": 1379,
                        "hh_spend_housing_80k_to_100k": 332,
                        "hh_spend_housing_60k_to_80k": 887,
                        "hh_spend_housing_40k_to_60k": 6425,
                        "hh_spend_housing_20k_to_40k": 7149,
                        "hh_spend_housing_0_to_20k": 1697,
                        "hh_spend_food_fmcg_35k_to_inf": 6250,
                        "hh_spend_food_fmcg_30k_to_35k": 3399,
                        "hh_spend_food_fmcg_25k_to_30k": 1000,
                        "hh_spend_food_fmcg_20k_to_25k": 2236,
                        "hh_spend_food_fmcg_17k_to_20k": 3610,
                        "hh_spend_food_fmcg_14k_to_17k": 935,
                        "hh_spend_food_fmcg_11k_to_14k": 721,
                        "hh_spend_food_fmcg_9k_to_11k": 119,
                        "hh_spend_food_fmcg_7k_to_9k": 0,
                        "hh_spend_food_fmcg_0_to_7k": 225,
                        "hh_spend_apparel_26k_to_inf": 626,
                        "hh_spend_apparel_22k_to_26k": 466,
                        "hh_spend_apparel_18k_to_22k": 1159,
                        "hh_spend_apparel_14k_to_18k": 90,
                        "hh_spend_apparel_10k_to_14k": 3909,
                        "hh_spend_apparel_8k_to_10k": 3999,
                        "hh_spend_apparel_6k_to_8k": 3070,
                        "hh_spend_apparel_4k_to_6k": 4763,
                        "hh_spend_apparel_2k_to_9k": 188,
                        "hh_spend_apparel_0_to_2k": 225,
                        "hh_spend_transportation_50k_to_inf": 0,
                        "hh_spend_transportation_40k_to_50k": 0,
                        "hh_spend_transportation_30k_to_40k": 1092,
                        "hh_spend_transportation_20k_to_30k": 1159,
                        "hh_spend_transportation_15k_to_20k": 324,
                        "hh_spend_transportation_10k_to_15k": 649,
                        "hh_spend_transportation_7k5c_to_10k": 4310,
                        "hh_spend_transportation_5k_to_7k5c": 2795,
                        "hh_spend_transportation_2k5c_to_5k": 7101,
                        "hh_spend_transportation_0_to_2k5c": 1065,
                        "hh_spend_healthcare_medical_30k_to_inf": 372,
                        "hh_spend_healthcare_medical_26k_to_30k": 254,
                        "hh_spend_healthcare_medical_22k_to_26k": 973,
                        "hh_spend_healthcare_medical_18k_to_22k": 652,
                        "hh_spend_healthcare_medical_14k_to_18k": 594,
                        "hh_spend_healthcare_medical_10k_to_14k": 6804,
                        "hh_spend_healthcare_medical_6k_to_10k": 1709,
                        "hh_spend_healthcare_medical_4k_to_6k": 5576,
                        "hh_spend_healthcare_medical_2k_to_4k": 1239,
                        "hh_spend_healthcare_medical_0_to_2k": 322,
                        "hh_spend_financial_savings_100k_to_inf": 0,
                        "hh_spend_financial_savings_85k_to_100k": 372,
                        "hh_spend_financial_savings_70k_to_85k": 254,
                        "hh_spend_financial_savings_55k_to_70k": 1625,
                        "hh_spend_financial_savings_40k_to_55k": 324,
                        "hh_spend_financial_savings_30k_to_40k": 1779,
                        "hh_spend_financial_savings_20k_to_30k": 5295,
                        "hh_spend_financial_savings_10k_to_20k": 5380,
                        "hh_spend_financial_savings_5k_to_10k": 3067,
                        "hh_spend_financial_savings_0_to_5k": 399,
                        "hh_spend_education_40k_to_inf": 0,
                        "hh_spend_education_30k_to_40k": 626,
                        "hh_spend_education_25k_to_30k": 1379,
                        "hh_spend_education_20k_to_25k": 246,
                        "hh_spend_education_16k_to_20k": 594,
                        "hh_spend_education_12k_to_16k": 2923,
                        "hh_spend_education_8k_to_12k": 6674,
                        "hh_spend_education_4k_to_8k": 5662,
                        "hh_spend_education_2k_to_4k": 166,
                        "hh_spend_education_0_to_2k": 225,
                        "hh_spend_entertainment_40k_to_inf": 0,
                        "hh_spend_entertainment_30k_to_40k": 1092,
                        "hh_spend_entertainment_25k_to_30k": 913,
                        "hh_spend_entertainment_20k_to_25k": 570,
                        "hh_spend_entertainment_16k_to_20k": 649,
                        "hh_spend_entertainment_12k_to_16k": 1169,
                        "hh_spend_entertainment_8k_to_12k": 5936,
                        "hh_spend_entertainment_4k_to_8k": 6767,
                        "hh_spend_entertainment_2k_to_4k": 1008,
                        "hh_spend_entertainment_0_to_2k": 391,
                        "hh_spend_per_dineout_4000_to_inf": 2823,
                        "hh_spend_per_dineout_3500_to_4000": 401,
                        "hh_spend_per_dineout_3000_to_3500": 3141,
                        "hh_spend_per_dineout_2500_to_3000": 3623,
                        "hh_spend_per_dineout_2000_to_2500": 341,
                        "hh_spend_per_dineout_1500_to_2000": 484,
                        "hh_spend_per_dineout_1200_to_1500": 2993,
                        "hh_spend_per_dineout_800_to_1200": 3326,
                        "hh_spend_per_dineout_500_to_800": 950,
                        "hh_spend_per_dineout_less_than_500": 0,
                        "hh_monthly_spend_on_dineout_30k_to_inf": 2003,
                        "hh_monthly_spend_on_dineout_25k_to_30k": 338,
                        "hh_monthly_spend_on_dineout_20k_to_25k": 482,
                        "hh_monthly_spend_on_dineout_15k_to_20k": 7165,
                        "hh_monthly_spend_on_dineout_12k_to_15k": 341,
                        "hh_monthly_spend_on_dineout_10k_to_12k": 0,
                        "hh_monthly_spend_on_dineout_7k_to_10k": 484,
                        "hh_monthly_spend_on_dineout_5k_to_7k": 3411,
                        "hh_monthly_spend_on_dineout_2k_to_5k": 2908,
                        "hh_monthly_spend_on_dineout_2000": 950,
                        "hh_spend_others_20k_to_inf": 585,
                        "hh_spend_others_17k5c_to_20k": 954,
                        "hh_spend_others_15k_to_17k5c": 1036,
                        "hh_spend_others_12k5c_to_15k": 0,
                        "hh_spend_others_10k_to_12k5c": 2821,
                        "hh_spend_others_8k_to_10k": 969,
                        "hh_spend_others_6k_to_8k": 1100,
                        "hh_spend_others_4k_to_6k": 5213,
                        "hh_spend_others_2k_to_4k": 5365,
                        "hh_spend_others_0_to_2k": 452,
                        "age_group_0_to_9_female": 8.96,
                        "age_group_0_to_9_male": 8.39,
                        "age_group_10_to_19_female": 6.71,
                        "age_group_10_to_19_male": 11.75,
                        "age_group_20_to_29_female": 10.13,
                        "age_group_20_to_29_male": 12.45,
                        "age_group_30_to_39_female": 6.91,
                        "age_group_30_to_39_male": 7.13,
                        "age_group_40_to_49_female": 5.57,
                        "age_group_40_to_49_male": 6.78,
                        "age_group_50_to_59_female": 3.32,
                        "age_group_50_to_59_male": 3.56,
                        "age_group_60_to_69_female": 2.42,
                        "age_group_60_to_69_male": 2.32,
                        "age_group_70_plus_female": 1.82,
                        "age_group_70_plus_male": 1.77,
                        "sec_a1": 10541,
                        "sec_a2": 28557,
                        "sec_a3": 0,
                        "sec_b1": 12098,
                        "sec_b2": 9798,
                        "sec_c1": 3662,
                        "sec_c2": 0,
                        "sec_d1": 4275,
                        "sec_d2": 0,
                        "sec_e1": 0,
                        "sec_e2": 841,
                        "sec_e3": 0,
                        "u_education_post_graduate": 20033,
                        "u_education_graduate": 16464,
                        "u_education_higher_secondary": 6072,
                        "u_education_primary_middle": 1523,
                        "u_education_illiterate": 330,
                        "u_occ_business": 12342,
                        "u_occ_salaried": 10124,
                        "u_occ_service": 14149,
                        "u_occ_workers": 3656,
                        "u_occ_marginal_workers": 830,
                        "u_occ_non_workers": 28746,
                        "u_occ_agri_workers": 0,
                        "hc_informed_urban": 14561,
                        "hc_carefree_anxious_urban": 3934,
                        "saving_plan": 13259,
                        "retirement_plan": 13583,
                        "unit_linked_plan": 2575,
                        "health": 0,
                        "mutual_fund": 10813,
                        "fixed_deposit": 16241,
                        "expected_rare_irregular_use": 1847,
                        "expected_moderate_avg_use": 5511,
                        "expected_heavy_frequent_use": 10072,
                        "real_estate_15l_25l": 0,
                        "real_estate_25l_50l": 1375,
                        "real_estate_51l_1cr": 7033,
                        "real_estate_1cr_4cr": 9765,
                        "real_estate_4cr_beyond": 0,
                        "fmcg_mass_fabric_products": 6903,
                        "fmcg_premium_fabric_products": 11358,
                        "fmcg_washing_machine_products": 17132,
                        "fmcg_personal_mass_classified": 1363,
                        "fmcg_personal_popular_classified": 7144,
                        "fmcg_personal_premium_classified": 9988,
                        "fmcg_packaged_food_mass_classified": 1697,
                        "fmcg_packaged_food_popular_classified": 6208,
                        "fmcg_packaged_food_premium_classified": 10590,
                        "fmcg_packaged_food_health_and_wellness": 10329,
                        "fmcg_cosmetics_mass_classified": 471,
                        "fmcg_cosmetics_popular_classified": 10352,
                        "fmcg_cosmetics_premium_classified": 7447,
                        "fashion_apparel_economy": 1697,
                        "fashion_apparel_medium": 5347,
                        "fashion_apparel_premium": 5272,
                        "fashion_apparel_super_premium": 3604,
                        "fashion_apparel_luxury": 2575,
                        "jewellery_gold_branded": 14596,
                        "jewellery_gold_traditional_non_branded": 2536,
                        "jewellery_gold_moderate_priced_gold": 7285,
                        "jewellery_gold_high_priced_gold": 9649,
                        "jewellery_gold_moderate_priced_diamond": 5564,
                        "jewellery_gold_high_priced_diamond": 10203,
                        "travel_short_term_basic": 10128,
                        "travel_short_term_luxury": 6670,
                        "travel_long_term_national": 10128,
                        "travel_long_term_international": 6670,
                        "travel_long_term_special": 5448,
                        "online_rare_irregular_use": 4746,
                        "online_moderate_avg_use": 6077,
                        "online_heavy_frequent_use": 7447,
                        "retail_home_living_high_priced": 6179,
                        "retail_home_living_moderate_priced": 10619,
                        "two_wheeler_entry_level_scooter_segment": 3920,
                        "two_wheeler_premium_scooter_segment": 1804,
                        "two_wheeler_entry_level_commuter_segment": 3351,
                        "two_wheeler_premium_commuter_segment": 1804,
                        "two_wheeler_entry_level_sports_bike_segment": 484,
                        "two_wheeler_premium_sports_bike_segment": 8693,
                        "two_wheeler_entry_level_cruiser_bike_segment": 0,
                        "two_wheeler_premium_cruiser_bike_segment": 874,
                        "two_wheeler_touring_bike_segment": 874,
                        "two_wheeler_off_road_bike_segment": 874,
                        "automobile_entry_price_segment": 634,
                        "automobile_entry_premium_hatch_segment": 634,
                        "automobile_premium_hatch_segment": 11198,
                        "automobile_compact_sedan_segment": 6803,
                        "automobile_sedan_segment": 5624,
                        "automobile_premium_sedan_segment": 626,
                        "automobile_compact_entry_suv_segment": 5624,
                        "automobile_suv_segment": 626,
                        "automobile_luxury_premium_sedan_suv_segment": 0,
                        "automobile_2nd_hand_sedan_segment": 4399,
                        "automobile_2nd_hand_premium_sedan_suv": 6250,
                        "automobile_2nd_hand_luxury_premium_sedan_suv": 0,
                        "smartphone_premium": 2341,
                        "smartphone_popular": 11824,
                        "smartphone_mass": 3265,
                        "washing_machine_premium": 2823,
                        "washing_machine_popular": 13559,
                        "washing_machine_mass": 2113,
                        "tv_premium": 2341,
                        "tv_popular": 7647,
                        "tv_mass": 7442,
                        "ac_premium": 9765,
                        "ac_popular": 648,
                        "ac_mass": 6176,
                        "refrigerator_premium": 2823,
                        "refrigerator_popular": 13559,
                        "refrigerator_mass": 2113,
                        "hot_spot_count": 13,
                        "atm_0_200m": 0,
                        "atm_200_500m": 1,
                        "bank_0_200m": 1,
                        "bank_200_500m": 2,
                        "cinema_halls_and_theatres_0_200m": 1,
                        "cinema_halls_and_theatres_200_500m": 0,
                        "cinema_halls_and_theatres_seat_count_0_200m": 0,
                        "cinema_halls_and_theatres_seat_count_200_500m": 0,
                        "educational_institutions_0_200m": 0,
                        "educational_institutions_200_500m": 2,
                        "educational_institutions_college_student_count_0_200m": 0,
                        "educational_institutions_college_student_count_200_500m": 0,
                        "entertainment_locations_0_200m": 0,
                        "entertainment_locations_200_500m": 0,
                        "fashion_and_apparel_0_200m": 2,
                        "fashion_and_apparel_200_500m": 1,
                        "furniture_stores_0_200m": 0,
                        "furniture_stores_200_500m": 0,
                        "gym_and_fitness_centres_0_200m": 1,
                        "gym_and_fitness_centres_200_500m": 1,
                        "hospitals_0_200m": 0,
                        "hospitals_200_500m": 0,
                        "hotels_0_200m": 0,
                        "hotels_200_500m": 0,
                        "jewellery_store_0_200m": 1,
                        "jewellery_store_200_500m": 1,
                        "luxury_brands_0_200m": 0,
                        "luxury_brands_200_500m": 0,
                        "office_locations_0_200m": 1,
                        "office_locations_200_500m": 1,
                        "employee_count_0_200m": 637,
                        "employee_count_200_500m": 1424,
                        "petrol_stations_0_200m": 0,
                        "petrol_stations_200_500m": 0,
                        "pharmacy_0_200m": 0,
                        "pharmacy_200_500m": 12,
                        "qsr_0_200m": 6,
                        "qsr_200_500m": 2,
                        "religious_places_0_200m": 0,
                        "religious_places_200_500m": 1,
                        "restaurants_and_cafe_0_200m": 5,
                        "restaurants_and_cafe_200_500m": 20,
                        "shopping_centres_and_malls_0_200m": 1,
                        "shopping_centres_and_malls_200_500m": 0,
                        "supermarkets_0_200m": 0,
                        "supermarkets_200_500m": 0,
                        "tourist_locations_0_200m": 0,
                        "tourist_locations_200_500m": 0,
                        "transit_hubs_0_200m": 0,
                        "transit_hubs_200_500m": 0,
                        "": 0,
                        "ID": 1,
                        "Latitutde": 28.392022,
                        "Longitude": 77.029832,
                        "unique_visitor_index": 1579,
                        "footfall_index": 16178,
                        "Total Footfall (MAID)": 0,
                        "Low INR <20,000": 93,
                        "Medium Low INR 20,000   40,000": 576,
                        "Medium INR 40,000   80,000": 4567,
                        "Medium Good INR 80,000   1,30,000": 8070,
                        "Good INR 1,30,000   1,70,000": 1110,
                        "Very Good INR 1,70,000   2,30,000": 763,
                        "High INR 2,30,000   3,00,000": 618,
                        "Very High INR > 3,00,000": 381,
                        "LSI 01: Urban Established Elite": 4650,
                        "LSI 02: Urban New Wealth": 305,
                        "LSI 03: Aspiring Urban Middle Class": 5323,
                        "LSI 04: Conservative Urban Middle Class": 1496,
                        "LSI 05: Successful Urban Fast Climbers": 1130,
                        "LSI 06: Upcoming Urban Climbers": 3107,
                        "LSI 07: Striving Urban Climbers": 47,
                        "LSI 08: Urban Dependants": 115,
                        "LSI 09: Daily Urban Survivors": 5
            }
];
        const poiData = [
            {
                        "id": 1073027,
                        "name": "Cult Gym Tulip Chowk Sector 69",
                        "category": "gym_and_fitness_centres",
                        "sub_category": "Cult Fit",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073028,
                        "name": "Hype The Gym Sector 70",
                        "category": "gym_and_fitness_centres",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073029,
                        "name": "Anytime Fitness",
                        "category": "gym_and_fitness_centres",
                        "sub_category": "Anytime Fitness",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073030,
                        "name": "ZUDIO",
                        "category": "fashion_and_apparel",
                        "sub_category": "Zudio",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073031,
                        "name": "OXYCARE PHARMACY",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073032,
                        "name": "Pyramid Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048990,
                        "name": "Healthcare Pharmacy Pharmacy shop Medical shop Medicine home delivery",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058537,
                        "name": "Naveen Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058538,
                        "name": "Shree Shyam Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058553,
                        "name": "Aggarwal Medical Hall",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058578,
                        "name": "Ganesh temple",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058580,
                        "name": "Rakesh Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072683,
                        "name": "Annikas Aroma",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Annikas Aroma",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072684,
                        "name": "Balaji Sweets Restaurant",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Balaji Sweets Restaurant",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072685,
                        "name": "Binge",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Binge",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072958,
                        "name": "Nirulas",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Nirulas",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072959,
                        "name": "Loop",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Loop",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072960,
                        "name": "Pindiwala 31",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Pindiwala 31",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072961,
                        "name": "Salsito",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Salsito",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072719,
                        "name": "Sana Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072981,
                        "name": "Cake Pizza",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cake Pizza",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073033,
                        "name": "Aarogya Homoeopathy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1097851,
                        "name": "De Adventure Park - farms",
                        "category": "entertainment_locations",
                        "sub_category": "Amusement Park",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1618831,
                        "name": "A to z pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1916377,
                        "name": "Manyavar",
                        "category": "fashion_and_apparel",
                        "sub_category": "Manyavar",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 2555922,
                        "name": "Kamla Medical And Cosmetics",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073043,
                        "name": "Sector 71",
                        "category": "qsr",
                        "sub_category": "KFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048963,
                        "name": "Krishna Furniture",
                        "category": "furniture_stores",
                        "sub_category": "Krishna Furniture",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048964,
                        "name": "Temple - Rama Enclave",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048985,
                        "name": "OM MEDICAL STORE",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048986,
                        "name": "health mart pharmacy sector 70A",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048987,
                        "name": "Max Health Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048988,
                        "name": "Dkj Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048989,
                        "name": "Kirshna pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072679,
                        "name": "Abcoffee",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Abcoffee",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072680,
                        "name": "The Beer Cafe",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Beer Cafe",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072687,
                        "name": "Chatore",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Chatore",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072688,
                        "name": "Delhi Ka Super Tandoori Momos",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Delhi Ka Super Tandoori Momos",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072691,
                        "name": "Kurkure Momos Wale",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Kurkure Momos Wale",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072692,
                        "name": "Lemon Drops",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Lemon Drops",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072694,
                        "name": "Shyam Sweets",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Shyam Sweets",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072695,
                        "name": "Supreme Cake Bakers",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Supreme Cake Bakers",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072696,
                        "name": "The Pizza Slice",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Pizza Slice",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072697,
                        "name": "Al Karim Haryana Hotel",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Al Karim Haryana Hotel",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072702,
                        "name": "House Of Biryan Biryani Kepsa And More",
                        "category": "restaurants_and_cafe",
                        "sub_category": "House Of Biryan Biryani Kepsa And More",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072703,
                        "name": "Pie Room",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Pie Room",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072704,
                        "name": "Chinar Dhaba",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Chinar Dhaba",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072739,
                        "name": "GURGAON SECTOR 48 BRANCH ATM",
                        "category": "atm",
                        "sub_category": "IDFC First Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072740,
                        "name": "Axis Bank ATM",
                        "category": "atm",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072741,
                        "name": "Axis Bank ATM Bestech Tower Sector 48 Gurgaon",
                        "category": "atm",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072742,
                        "name": "Axis Bank ATM Near Kanhai Mode",
                        "category": "atm",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072743,
                        "name": "Axis Bank ATM",
                        "category": "atm",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072744,
                        "name": "STATE BANK OF INDIA",
                        "category": "atm",
                        "sub_category": "State Bank of India",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072745,
                        "name": "STATE BANK OF INDIA",
                        "category": "atm",
                        "sub_category": "State Bank of India",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072746,
                        "name": "STATE BANK OF INDIA",
                        "category": "atm",
                        "sub_category": "State Bank of India",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072750,
                        "name": "ICICI Gurgaon Spaze Palazo Sec",
                        "category": "bank",
                        "sub_category": "ICICI Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072751,
                        "name": "ICICI Sector",
                        "category": "bank",
                        "sub_category": "ICICI Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072752,
                        "name": "GURGAON - SECTOR 48 BRANCH",
                        "category": "bank",
                        "sub_category": "IDFC First Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072754,
                        "name": "Axis Bank Branch Bestech Tower Sector 48 Gurgaon",
                        "category": "bank",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072755,
                        "name": "State Bank Of India",
                        "category": "bank",
                        "sub_category": "State Bank of India",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072757,
                        "name": "HDFC Bank - Spaze Palazo Sector - 69",
                        "category": "bank",
                        "sub_category": "HDFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072872,
                        "name": "Valentino Pizzeria By Nirulas",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Valentino Pizzeria By Nirulas",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072883,
                        "name": "The Bhojanpure Veg Delights",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Bhojanpure Veg Delights",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072932,
                        "name": "HDFC Bank ATM - darbaripur",
                        "category": "atm",
                        "sub_category": "HDFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072935,
                        "name": "SURAJ DEGREE COLLEGE",
                        "category": "educational_institutions",
                        "sub_category": "Colleges and Univesities",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072952,
                        "name": "The Vivekananda School",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072953,
                        "name": "Indus World School",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072962,
                        "name": "Soul Mykonos",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Soul Mykonos",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072963,
                        "name": "Taaka Chinese",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Taaka Chinese",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072964,
                        "name": "The Knot Courtyard",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Knot Courtyard",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072965,
                        "name": "Kolkata Kravings",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Kolkata Kravings",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072966,
                        "name": "Kolkata Yummy",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Kolkata Yummy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072967,
                        "name": "Cool Deck Coffee",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cool Deck Coffee",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072968,
                        "name": "Cool Deck Pizza",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cool Deck Pizza",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072969,
                        "name": "Calcutta Culinary",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Calcutta Culinary",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072970,
                        "name": "The Pizza Experts",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Pizza Experts",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072971,
                        "name": "Fast Food Xpress",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Fast Food Xpress",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072972,
                        "name": "Freshmenu",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Freshmenu",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072973,
                        "name": "Bowl Soul",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Bowl Soul",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072974,
                        "name": "Pita Pit",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Pita Pit",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072975,
                        "name": "Albake Muradabadi Chicken Corner",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Albake Muradabadi Chicken Corner",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072976,
                        "name": "Angara",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Angara",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072977,
                        "name": "Btech Chaapwala",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Btech Chaapwala",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072978,
                        "name": "Burrppp",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Burrppp",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072979,
                        "name": "Cake Crown",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cake Crown",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072980,
                        "name": "Cake Master",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cake Master",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072982,
                        "name": "Cake Point",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cake Point",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072983,
                        "name": "Cake Shop",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cake Shop",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072984,
                        "name": "Cake Zone",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cake Zone",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072985,
                        "name": "Cakestaan Freshly Baked Cakes And Pizza",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cakestaan Freshly Baked Cakes And Pizza",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072986,
                        "name": "Cakestaanfreshly Baked Cakes",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Cakestaanfreshly Baked Cakes",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072987,
                        "name": "Donburi",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Donburi",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072988,
                        "name": "Dosa Ratnam",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Dosa Ratnam",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072989,
                        "name": "Harish Bakery",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Harish Bakery",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072990,
                        "name": "Kung Thai",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Kung Thai",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072991,
                        "name": "Kwality Walls Ice Cream And More",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Kwality Walls Ice Cream And More",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072992,
                        "name": "Ministrry Of Burger",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Ministrry Of Burger",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072993,
                        "name": "Pari Cake",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Pari Cake",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072994,
                        "name": "Pizza Zone",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Pizza Zone",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072995,
                        "name": "Rollsking",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Rollsking",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072996,
                        "name": "Sobers Tandoori Charcha",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Sobers Tandoori Charcha",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072997,
                        "name": "The Urban Food",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Urban Food",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072998,
                        "name": "Whisk Cake Studio",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Whisk Cake Studio",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072999,
                        "name": "Wow China",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Wow China",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073000,
                        "name": "Apna Champaran Handi Meat",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Apna Champaran Handi Meat",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073001,
                        "name": "Bheemeshwara A South Indian Delicacy",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Bheemeshwara A South Indian Delicacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073002,
                        "name": "Chicken Rasoi",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Chicken Rasoi",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073003,
                        "name": "The Spice Saga",
                        "category": "restaurants_and_cafe",
                        "sub_category": "The Spice Saga",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073004,
                        "name": "Kulcha Lal Parantha Das",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Kulcha Lal Parantha Das",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073005,
                        "name": "Indian Oil",
                        "category": "petrol_stations",
                        "sub_category": "Indian Oil",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073034,
                        "name": "Axis Bank ATM",
                        "category": "atm",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073035,
                        "name": "STATE BANK OF INDIA",
                        "category": "atm",
                        "sub_category": "State Bank of India",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073036,
                        "name": "Gurugram - Sec 69 Branch Recycler",
                        "category": "atm",
                        "sub_category": "Kotak Mahindra Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073037,
                        "name": "Axis Bank ATM Sector 57 Gurgaon",
                        "category": "atm",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073038,
                        "name": "HDFC Bank ATM - Pyramid Square Sector 70A",
                        "category": "atm",
                        "sub_category": "HDFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073039,
                        "name": "HDFC Bank ATM - Pioneer Urban Square  Sector - 62",
                        "category": "atm",
                        "sub_category": "HDFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073040,
                        "name": "Gurugram - Sec 69",
                        "category": "bank",
                        "sub_category": "Kotak Mahindra Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073041,
                        "name": "Axis Bank Branch Sector 69 Gurgaon",
                        "category": "bank",
                        "sub_category": "Axis Bank",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073042,
                        "name": "HDFC Bank - Sector 70",
                        "category": "bank",
                        "sub_category": "HDFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073044,
                        "name": "Reach3 Roads-WM",
                        "category": "qsr",
                        "sub_category": "Wow! Momo",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073045,
                        "name": "Blue Tokai Coffee Roasters | Good Earth Sixty 9",
                        "category": "qsr",
                        "sub_category": "Blue Tokai",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073046,
                        "name": "3 Roads",
                        "category": "qsr",
                        "sub_category": "Starbucks",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073047,
                        "name": "McDonald's REACH 3 ROADS",
                        "category": "qsr",
                        "sub_category": "McDonalds",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073048,
                        "name": "Domino's Pizza - Reach 3 Roads Gurgaon",
                        "category": "qsr",
                        "sub_category": "Dominos Pizza",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073049,
                        "name": "Pizza Hut - Ph M3M Broadway Gurugram",
                        "category": "qsr",
                        "sub_category": "Pizza Hut",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073050,
                        "name": "Reach 3 - Gurgaon",
                        "category": "qsr",
                        "sub_category": "Chaayos",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1097850,
                        "name": "COCO BP BADSHAHPUR",
                        "category": "petrol_stations",
                        "sub_category": "COCO BP BADSHAHPUR",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1616142,
                        "name": "GPS PALRA",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1616160,
                        "name": "GSSS PALRA",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1616161,
                        "name": "LAKSHYA DAKSHYA PUBLIC SCHOOL PALRA",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874370,
                        "name": "Bestech Business Tower",
                        "category": "office_locations",
                        "sub_category": "2500 - 5000",
                        "employee_count": 4919,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874372,
                        "name": "Kore Tech Park",
                        "category": "office_locations",
                        "sub_category": "2500 - 5000",
                        "employee_count": 3972,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874377,
                        "name": "Spaze Palazo",
                        "category": "office_locations",
                        "sub_category": "2500 - 5000",
                        "employee_count": 2867,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874445,
                        "name": "New Municipal Corporation Of Gurgaon Badshahpur Office",
                        "category": "office_locations",
                        "sub_category": "< 500",
                        "employee_count": 39,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874448,
                        "name": "Tata Realty & Infrastructure",
                        "category": "office_locations",
                        "sub_category": "2500 - 5000",
                        "employee_count": 3014,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874473,
                        "name": "Spaze Corporate Park",
                        "category": "office_locations",
                        "sub_category": "1000 - 2500",
                        "employee_count": 1424,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874481,
                        "name": "Reach My Tower",
                        "category": "office_locations",
                        "sub_category": "500 - 1000",
                        "employee_count": 637,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1874715,
                        "name": "M3m Broadway",
                        "category": "office_locations",
                        "sub_category": "5000 - 7500",
                        "employee_count": 5612,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1996637,
                        "name": "Costa Coffee",
                        "category": "qsr",
                        "sub_category": "Costa Coffee",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3265377,
                        "name": "Subway",
                        "category": "qsr",
                        "sub_category": "Subway",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3402242,
                        "name": "HDFC Bank ATM - AIPL Boulevard Sector 70A",
                        "category": "atm",
                        "sub_category": "HDFC",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048965,
                        "name": "Shiv Mandirclose to forniture shop",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048966,
                        "name": "Royal Oak",
                        "category": "furniture_stores",
                        "sub_category": "Royal Oak",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048968,
                        "name": "N. Gupta Electronics & Engineers",
                        "category": "furniture_stores",
                        "sub_category": "Godrej Interio",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048969,
                        "name": "Tulip Mandir",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048970,
                        "name": "Shiv mandir",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048974,
                        "name": "Apollo Pharmacy Gurugram Sector 69",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048975,
                        "name": "Neel Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3048984,
                        "name": "STANDARD PHARMACY",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058581,
                        "name": "Kamal Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058582,
                        "name": "Aggarwal Medicose",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058585,
                        "name": "Vishal Mega Mart",
                        "category": "supermarkets",
                        "sub_category": "Vishal Mega Mart",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058591,
                        "name": "First Care Health Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058603,
                        "name": "Ravidas mandir Badshahpur",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058604,
                        "name": "Yadav Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058605,
                        "name": "Shri Ram Ji Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3058606,
                        "name": "Ajanta Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3208264,
                        "name": "De Adventure Park - farms",
                        "category": "tourist_locations",
                        "sub_category": "De Adventure Park - farms",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3245718,
                        "name": "Akash Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3260407,
                        "name": "Westside",
                        "category": "fashion_and_apparel",
                        "sub_category": "Westside",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 3360694,
                        "name": "MAIN SITA RAM MANDIR",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072213,
                        "name": "Panchamrita Food Ventures",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Panchamrita Food Ventures",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072281,
                        "name": "V Club",
                        "category": "restaurants_and_cafe",
                        "sub_category": "V Club",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072368,
                        "name": "Simran Foods & Caterers",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Simran Foods & Caterers",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072693,
                        "name": "Prime Star Kitchen",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Prime Star Kitchen",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072382,
                        "name": "A One Muradabadi Chicken Biryani Corner",
                        "category": "restaurants_and_cafe",
                        "sub_category": "A One Muradabadi Chicken Biryani Corner",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072671,
                        "name": "Rao Maharam Memorial School",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072672,
                        "name": "Krazy Kebab Co",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Krazy Kebab Co",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072673,
                        "name": "Mealy Your Everyday Meal",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Mealy Your Everyday Meal",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072674,
                        "name": "Mopp Mad Over Parathas & Pakodas",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Mopp Mad Over Parathas & Pakodas",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072676,
                        "name": "Sugandh69",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Sugandh69",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072681,
                        "name": "Goila Butter Chicken",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Goila Butter Chicken",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072682,
                        "name": "Amazing Bakers",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Amazing Bakers",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072698,
                        "name": "Biryani By Kilo",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Biryani By Kilo",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072699,
                        "name": "Champaran Meat Co",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Champaran Meat Co",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072700,
                        "name": "Gajab Ka Dhaba",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Gajab Ka Dhaba",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072701,
                        "name": "Gaon",
                        "category": "restaurants_and_cafe",
                        "sub_category": "Gaon",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072955,
                        "name": "Rama Krishna Public School",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072957,
                        "name": "School",
                        "category": "educational_institutions",
                        "sub_category": "Schools",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073009,
                        "name": "Medmart Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073010,
                        "name": "Lifemed Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072251,
                        "name": "Prachin Shiv Ji Temple",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072254,
                        "name": "Diwan medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072331,
                        "name": "Gurgaon Bible Church",
                        "category": "religious_places",
                        "sub_category": "Church",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072386,
                        "name": "Pari Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072387,
                        "name": "OM PHARMACY",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072389,
                        "name": "SK Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072600,
                        "name": "Sethi Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072705,
                        "name": "Meeraji HospitalMultispecialityTrauma and Maternity Centre",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072706,
                        "name": "Hanuman Mandir",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072707,
                        "name": "Badi Mata Mandir Darbaripur road",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072708,
                        "name": "Ram Talab Mandir",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072709,
                        "name": "RADHA KRISHNA MANDIR BADSHAHPUR",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072710,
                        "name": "Radha krishan Mandir noorpur",
                        "category": "religious_places",
                        "sub_category": "Temple",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072711,
                        "name": "Shree shyam medical agency",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072712,
                        "name": "Shri Krishna Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072714,
                        "name": "Lallittashree Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072715,
                        "name": "Rupesh Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072716,
                        "name": "A1 PHARMACY COSMETICS",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072717,
                        "name": "Shree Makhan Lal Memorial Charitable Dispensary",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072718,
                        "name": "Apollo Pharmacy Gurgaon Sec 49",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072720,
                        "name": "Tata 1mg Pharmacy Lab Tests",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072721,
                        "name": "Deepak healthcare",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072722,
                        "name": "Apple pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072723,
                        "name": "Home Health Medicose Sohna Road Darbaripur More Badshahpur",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072724,
                        "name": "Godara Medical Hall",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072725,
                        "name": "Riyansh Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072726,
                        "name": "Rishabh Medicose",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072727,
                        "name": "Haryana Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072728,
                        "name": "Krishna Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072729,
                        "name": "Medihouse Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072730,
                        "name": "Krishna medicose",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072731,
                        "name": "Yadav Medicos",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072733,
                        "name": "JIWAN DHARA HOSPITAL",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072734,
                        "name": "VEDIK HOSPITAL",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072735,
                        "name": "MOKSH HOSPITAL MULTISPECIALITY",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072736,
                        "name": "Sai Life Care E Homeopathic Hasptal",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072737,
                        "name": "Badshahpur Forest Corridor",
                        "category": "tourist_locations",
                        "sub_category": "Badshahpur Forest Corridor",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072896,
                        "name": "Pill Club Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072897,
                        "name": "MAIRA MEDICAL STORE",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072898,
                        "name": "Nidhi Medical Store",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073008,
                        "name": "Apollo Pharmacy Gurgaon Sector 70",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073011,
                        "name": "Tata 1mg Pharmacy Lab Tests",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073012,
                        "name": "well health pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073013,
                        "name": "Sanjivini Sangraha Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073014,
                        "name": "Virat pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073015,
                        "name": "Davaindia Generic Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073016,
                        "name": "Nearby Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073017,
                        "name": "Green India Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073018,
                        "name": "Alka pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073019,
                        "name": "Parth Rx Pharmacy",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073020,
                        "name": "The Chemist Shop",
                        "category": "pharmacy",
                        "sub_category": "Pharmacy",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073022,
                        "name": "Reach 3roads",
                        "category": "shopping_centres_and_malls",
                        "sub_category": "Reach 3roads",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073023,
                        "name": "ANANTA HOSPITAL",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073024,
                        "name": "Ajay Devgn`s NY Cinemas: Elan Epic Mall",
                        "category": "cinema_halls_and_theatres",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073025,
                        "name": "Good Earth 69 Gurugram",
                        "category": "jewellery_store",
                        "sub_category": "Bluestone",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1073026,
                        "name": "Good Earth Sixty9",
                        "category": "jewellery_store",
                        "sub_category": "CaratLane",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            },
            {
                        "id": 1072914,
                        "name": "Akropolis Super Speciality Hospital Orthopedic Hospital in Gurgaon  Neuro Cardiologist CT Scan ENT Hospital in Gurgaon",
                        "category": "hospitals",
                        "sub_category": "Others",
                        "employee_count": 0,
                        "cinema_hall_seat_count": 0,
                        "pincode": 1,
                        "Location ": "FreshX"
            }
];
        const competitorsData = [
            {
                        "Name": "Vishal Mega Mart",
                        "Latitude": 28.390325,
                        "Longitude": 77.050015,
                        "color": "#FF5F1F"
            }
];
        const gpkgData = {
            "type": "FeatureCollection",
            "features": [
                        {
                                    "id": "0",
                                    "type": "Feature",
                                    "properties": {
                                                "ID": 1,
                                                "Name": "FreshX",
                                                "Latitude": 28.392022,
                                                "Longitude": 77.029832
                                    },
                                    "geometry": {
                                                "type": "Polygon",
                                                "coordinates": [
                                                            [
                                                                        [
                                                                                    77.050278,
                                                                                    28.392022
                                                                        ],
                                                                        [
                                                                                    77.050276,
                                                                                    28.392248
                                                                        ],
                                                                        [
                                                                                    77.050271,
                                                                                    28.392474
                                                                        ],
                                                                        [
                                                                                    77.050263,
                                                                                    28.3927
                                                                        ],
                                                                        [
                                                                                    77.050252,
                                                                                    28.392926
                                                                        ],
                                                                        [
                                                                                    77.050237,
                                                                                    28.393151
                                                                        ],
                                                                        [
                                                                                    77.05022,
                                                                                    28.393377
                                                                        ],
                                                                        [
                                                                                    77.050199,
                                                                                    28.393602
                                                                        ],
                                                                        [
                                                                                    77.050175,
                                                                                    28.393827
                                                                        ],
                                                                        [
                                                                                    77.050147,
                                                                                    28.394052
                                                                        ],
                                                                        [
                                                                                    77.050117,
                                                                                    28.394276
                                                                        ],
                                                                        [
                                                                                    77.050083,
                                                                                    28.3945
                                                                        ],
                                                                        [
                                                                                    77.050046,
                                                                                    28.394724
                                                                        ],
                                                                        [
                                                                                    77.050006,
                                                                                    28.394947
                                                                        ],
                                                                        [
                                                                                    77.049962,
                                                                                    28.39517
                                                                        ],
                                                                        [
                                                                                    77.049916,
                                                                                    28.395392
                                                                        ],
                                                                        [
                                                                                    77.049866,
                                                                                    28.395614
                                                                        ],
                                                                        [
                                                                                    77.049813,
                                                                                    28.395835
                                                                        ],
                                                                        [
                                                                                    77.049757,
                                                                                    28.396056
                                                                        ],
                                                                        [
                                                                                    77.049698,
                                                                                    28.396276
                                                                        ],
                                                                        [
                                                                                    77.049635,
                                                                                    28.396495
                                                                        ],
                                                                        [
                                                                                    77.04957,
                                                                                    28.396714
                                                                        ],
                                                                        [
                                                                                    77.049501,
                                                                                    28.396931
                                                                        ],
                                                                        [
                                                                                    77.04943,
                                                                                    28.397148
                                                                        ],
                                                                        [
                                                                                    77.049355,
                                                                                    28.397365
                                                                        ],
                                                                        [
                                                                                    77.049277,
                                                                                    28.39758
                                                                        ],
                                                                        [
                                                                                    77.049196,
                                                                                    28.397795
                                                                        ],
                                                                        [
                                                                                    77.049112,
                                                                                    28.398008
                                                                        ],
                                                                        [
                                                                                    77.049025,
                                                                                    28.398221
                                                                        ],
                                                                        [
                                                                                    77.048935,
                                                                                    28.398433
                                                                        ],
                                                                        [
                                                                                    77.048842,
                                                                                    28.398643
                                                                        ],
                                                                        [
                                                                                    77.048746,
                                                                                    28.398853
                                                                        ],
                                                                        [
                                                                                    77.048647,
                                                                                    28.399061
                                                                        ],
                                                                        [
                                                                                    77.048545,
                                                                                    28.399269
                                                                        ],
                                                                        [
                                                                                    77.04844,
                                                                                    28.399475
                                                                        ],
                                                                        [
                                                                                    77.048332,
                                                                                    28.39968
                                                                        ],
                                                                        [
                                                                                    77.048221,
                                                                                    28.399884
                                                                        ],
                                                                        [
                                                                                    77.048107,
                                                                                    28.400087
                                                                        ],
                                                                        [
                                                                                    77.047991,
                                                                                    28.400288
                                                                        ],
                                                                        [
                                                                                    77.047871,
                                                                                    28.400488
                                                                        ],
                                                                        [
                                                                                    77.047749,
                                                                                    28.400687
                                                                        ],
                                                                        [
                                                                                    77.047624,
                                                                                    28.400884
                                                                        ],
                                                                        [
                                                                                    77.047496,
                                                                                    28.40108
                                                                        ],
                                                                        [
                                                                                    77.047365,
                                                                                    28.401275
                                                                        ],
                                                                        [
                                                                                    77.047231,
                                                                                    28.401468
                                                                        ],
                                                                        [
                                                                                    77.047095,
                                                                                    28.40166
                                                                        ],
                                                                        [
                                                                                    77.046956,
                                                                                    28.40185
                                                                        ],
                                                                        [
                                                                                    77.046814,
                                                                                    28.402038
                                                                        ],
                                                                        [
                                                                                    77.04667,
                                                                                    28.402225
                                                                        ],
                                                                        [
                                                                                    77.046523,
                                                                                    28.40241
                                                                        ],
                                                                        [
                                                                                    77.046373,
                                                                                    28.402594
                                                                        ],
                                                                        [
                                                                                    77.046221,
                                                                                    28.402776
                                                                        ],
                                                                        [
                                                                                    77.046066,
                                                                                    28.402957
                                                                        ],
                                                                        [
                                                                                    77.045908,
                                                                                    28.403135
                                                                        ],
                                                                        [
                                                                                    77.045748,
                                                                                    28.403312
                                                                        ],
                                                                        [
                                                                                    77.045586,
                                                                                    28.403487
                                                                        ],
                                                                        [
                                                                                    77.045421,
                                                                                    28.40366
                                                                        ],
                                                                        [
                                                                                    77.045253,
                                                                                    28.403832
                                                                        ],
                                                                        [
                                                                                    77.045083,
                                                                                    28.404001
                                                                        ],
                                                                        [
                                                                                    77.044911,
                                                                                    28.404169
                                                                        ],
                                                                        [
                                                                                    77.044736,
                                                                                    28.404335
                                                                        ],
                                                                        [
                                                                                    77.044559,
                                                                                    28.404498
                                                                        ],
                                                                        [
                                                                                    77.04438,
                                                                                    28.40466
                                                                        ],
                                                                        [
                                                                                    77.044198,
                                                                                    28.40482
                                                                        ],
                                                                        [
                                                                                    77.044014,
                                                                                    28.404978
                                                                        ],
                                                                        [
                                                                                    77.043828,
                                                                                    28.405134
                                                                        ],
                                                                        [
                                                                                    77.04364,
                                                                                    28.405287
                                                                        ],
                                                                        [
                                                                                    77.043449,
                                                                                    28.405439
                                                                        ],
                                                                        [
                                                                                    77.043256,
                                                                                    28.405588
                                                                        ],
                                                                        [
                                                                                    77.043062,
                                                                                    28.405736
                                                                        ],
                                                                        [
                                                                                    77.042865,
                                                                                    28.405881
                                                                        ],
                                                                        [
                                                                                    77.042666,
                                                                                    28.406024
                                                                        ],
                                                                        [
                                                                                    77.042465,
                                                                                    28.406165
                                                                        ],
                                                                        [
                                                                                    77.042262,
                                                                                    28.406303
                                                                        ],
                                                                        [
                                                                                    77.042057,
                                                                                    28.406439
                                                                        ],
                                                                        [
                                                                                    77.04185,
                                                                                    28.406573
                                                                        ],
                                                                        [
                                                                                    77.041641,
                                                                                    28.406705
                                                                        ],
                                                                        [
                                                                                    77.04143,
                                                                                    28.406834
                                                                        ],
                                                                        [
                                                                                    77.041218,
                                                                                    28.406961
                                                                        ],
                                                                        [
                                                                                    77.041003,
                                                                                    28.407086
                                                                        ],
                                                                        [
                                                                                    77.040787,
                                                                                    28.407208
                                                                        ],
                                                                        [
                                                                                    77.04057,
                                                                                    28.407328
                                                                        ],
                                                                        [
                                                                                    77.04035,
                                                                                    28.407446
                                                                        ],
                                                                        [
                                                                                    77.040129,
                                                                                    28.407561
                                                                        ],
                                                                        [
                                                                                    77.039906,
                                                                                    28.407674
                                                                        ],
                                                                        [
                                                                                    77.039682,
                                                                                    28.407784
                                                                        ],
                                                                        [
                                                                                    77.039456,
                                                                                    28.407891
                                                                        ],
                                                                        [
                                                                                    77.039228,
                                                                                    28.407996
                                                                        ],
                                                                        [
                                                                                    77.039,
                                                                                    28.408099
                                                                        ],
                                                                        [
                                                                                    77.038769,
                                                                                    28.408199
                                                                        ],
                                                                        [
                                                                                    77.038537,
                                                                                    28.408297
                                                                        ],
                                                                        [
                                                                                    77.038304,
                                                                                    28.408392
                                                                        ],
                                                                        [
                                                                                    77.03807,
                                                                                    28.408484
                                                                        ],
                                                                        [
                                                                                    77.037834,
                                                                                    28.408574
                                                                        ],
                                                                        [
                                                                                    77.037597,
                                                                                    28.408661
                                                                        ],
                                                                        [
                                                                                    77.037359,
                                                                                    28.408745
                                                                        ],
                                                                        [
                                                                                    77.037119,
                                                                                    28.408827
                                                                        ],
                                                                        [
                                                                                    77.036878,
                                                                                    28.408906
                                                                        ],
                                                                        [
                                                                                    77.036637,
                                                                                    28.408983
                                                                        ],
                                                                        [
                                                                                    77.036394,
                                                                                    28.409057
                                                                        ],
                                                                        [
                                                                                    77.03615,
                                                                                    28.409128
                                                                        ],
                                                                        [
                                                                                    77.035905,
                                                                                    28.409197
                                                                        ],
                                                                        [
                                                                                    77.035659,
                                                                                    28.409262
                                                                        ],
                                                                        [
                                                                                    77.035413,
                                                                                    28.409325
                                                                        ],
                                                                        [
                                                                                    77.035165,
                                                                                    28.409386
                                                                        ],
                                                                        [
                                                                                    77.034917,
                                                                                    28.409443
                                                                        ],
                                                                        [
                                                                                    77.034667,
                                                                                    28.409498
                                                                        ],
                                                                        [
                                                                                    77.034417,
                                                                                    28.40955
                                                                        ],
                                                                        [
                                                                                    77.034167,
                                                                                    28.4096
                                                                        ],
                                                                        [
                                                                                    77.033915,
                                                                                    28.409646
                                                                        ],
                                                                        [
                                                                                    77.033663,
                                                                                    28.40969
                                                                        ],
                                                                        [
                                                                                    77.03341,
                                                                                    28.409731
                                                                        ],
                                                                        [
                                                                                    77.033157,
                                                                                    28.409769
                                                                        ],
                                                                        [
                                                                                    77.032903,
                                                                                    28.409804
                                                                        ],
                                                                        [
                                                                                    77.032649,
                                                                                    28.409837
                                                                        ],
                                                                        [
                                                                                    77.032395,
                                                                                    28.409867
                                                                        ],
                                                                        [
                                                                                    77.032139,
                                                                                    28.409894
                                                                        ],
                                                                        [
                                                                                    77.031884,
                                                                                    28.409918
                                                                        ],
                                                                        [
                                                                                    77.031628,
                                                                                    28.409939
                                                                        ],
                                                                        [
                                                                                    77.031372,
                                                                                    28.409957
                                                                        ],
                                                                        [
                                                                                    77.031116,
                                                                                    28.409973
                                                                        ],
                                                                        [
                                                                                    77.030859,
                                                                                    28.409986
                                                                        ],
                                                                        [
                                                                                    77.030603,
                                                                                    28.409996
                                                                        ],
                                                                        [
                                                                                    77.030346,
                                                                                    28.410003
                                                                        ],
                                                                        [
                                                                                    77.030089,
                                                                                    28.410007
                                                                        ],
                                                                        [
                                                                                    77.029832,
                                                                                    28.410008
                                                                        ],
                                                                        [
                                                                                    77.029575,
                                                                                    28.410007
                                                                        ],
                                                                        [
                                                                                    77.029318,
                                                                                    28.410003
                                                                        ],
                                                                        [
                                                                                    77.029061,
                                                                                    28.409996
                                                                        ],
                                                                        [
                                                                                    77.028805,
                                                                                    28.409986
                                                                        ],
                                                                        [
                                                                                    77.028548,
                                                                                    28.409973
                                                                        ],
                                                                        [
                                                                                    77.028292,
                                                                                    28.409957
                                                                        ],
                                                                        [
                                                                                    77.028036,
                                                                                    28.409939
                                                                        ],
                                                                        [
                                                                                    77.02778,
                                                                                    28.409918
                                                                        ],
                                                                        [
                                                                                    77.027525,
                                                                                    28.409894
                                                                        ],
                                                                        [
                                                                                    77.027269,
                                                                                    28.409867
                                                                        ],
                                                                        [
                                                                                    77.027015,
                                                                                    28.409837
                                                                        ],
                                                                        [
                                                                                    77.026761,
                                                                                    28.409804
                                                                        ],
                                                                        [
                                                                                    77.026507,
                                                                                    28.409769
                                                                        ],
                                                                        [
                                                                                    77.026254,
                                                                                    28.409731
                                                                        ],
                                                                        [
                                                                                    77.026001,
                                                                                    28.40969
                                                                        ],
                                                                        [
                                                                                    77.025749,
                                                                                    28.409646
                                                                        ],
                                                                        [
                                                                                    77.025497,
                                                                                    28.4096
                                                                        ],
                                                                        [
                                                                                    77.025247,
                                                                                    28.40955
                                                                        ],
                                                                        [
                                                                                    77.024997,
                                                                                    28.409498
                                                                        ],
                                                                        [
                                                                                    77.024747,
                                                                                    28.409443
                                                                        ],
                                                                        [
                                                                                    77.024499,
                                                                                    28.409386
                                                                        ],
                                                                        [
                                                                                    77.024251,
                                                                                    28.409325
                                                                        ],
                                                                        [
                                                                                    77.024005,
                                                                                    28.409262
                                                                        ],
                                                                        [
                                                                                    77.023759,
                                                                                    28.409197
                                                                        ],
                                                                        [
                                                                                    77.023514,
                                                                                    28.409128
                                                                        ],
                                                                        [
                                                                                    77.02327,
                                                                                    28.409057
                                                                        ],
                                                                        [
                                                                                    77.023027,
                                                                                    28.408983
                                                                        ],
                                                                        [
                                                                                    77.022786,
                                                                                    28.408906
                                                                        ],
                                                                        [
                                                                                    77.022545,
                                                                                    28.408827
                                                                        ],
                                                                        [
                                                                                    77.022305,
                                                                                    28.408745
                                                                        ],
                                                                        [
                                                                                    77.022067,
                                                                                    28.408661
                                                                        ],
                                                                        [
                                                                                    77.02183,
                                                                                    28.408574
                                                                        ],
                                                                        [
                                                                                    77.021594,
                                                                                    28.408484
                                                                        ],
                                                                        [
                                                                                    77.02136,
                                                                                    28.408392
                                                                        ],
                                                                        [
                                                                                    77.021127,
                                                                                    28.408297
                                                                        ],
                                                                        [
                                                                                    77.020895,
                                                                                    28.408199
                                                                        ],
                                                                        [
                                                                                    77.020664,
                                                                                    28.408099
                                                                        ],
                                                                        [
                                                                                    77.020436,
                                                                                    28.407996
                                                                        ],
                                                                        [
                                                                                    77.020208,
                                                                                    28.407891
                                                                        ],
                                                                        [
                                                                                    77.019982,
                                                                                    28.407784
                                                                        ],
                                                                        [
                                                                                    77.019758,
                                                                                    28.407674
                                                                        ],
                                                                        [
                                                                                    77.019535,
                                                                                    28.407561
                                                                        ],
                                                                        [
                                                                                    77.019314,
                                                                                    28.407446
                                                                        ],
                                                                        [
                                                                                    77.019094,
                                                                                    28.407328
                                                                        ],
                                                                        [
                                                                                    77.018877,
                                                                                    28.407208
                                                                        ],
                                                                        [
                                                                                    77.018661,
                                                                                    28.407086
                                                                        ],
                                                                        [
                                                                                    77.018446,
                                                                                    28.406961
                                                                        ],
                                                                        [
                                                                                    77.018234,
                                                                                    28.406834
                                                                        ],
                                                                        [
                                                                                    77.018023,
                                                                                    28.406705
                                                                        ],
                                                                        [
                                                                                    77.017814,
                                                                                    28.406573
                                                                        ],
                                                                        [
                                                                                    77.017607,
                                                                                    28.406439
                                                                        ],
                                                                        [
                                                                                    77.017402,
                                                                                    28.406303
                                                                        ],
                                                                        [
                                                                                    77.017199,
                                                                                    28.406165
                                                                        ],
                                                                        [
                                                                                    77.016998,
                                                                                    28.406024
                                                                        ],
                                                                        [
                                                                                    77.016799,
                                                                                    28.405881
                                                                        ],
                                                                        [
                                                                                    77.016602,
                                                                                    28.405736
                                                                        ],
                                                                        [
                                                                                    77.016408,
                                                                                    28.405588
                                                                        ],
                                                                        [
                                                                                    77.016215,
                                                                                    28.405439
                                                                        ],
                                                                        [
                                                                                    77.016024,
                                                                                    28.405287
                                                                        ],
                                                                        [
                                                                                    77.015836,
                                                                                    28.405134
                                                                        ],
                                                                        [
                                                                                    77.01565,
                                                                                    28.404978
                                                                        ],
                                                                        [
                                                                                    77.015466,
                                                                                    28.40482
                                                                        ],
                                                                        [
                                                                                    77.015284,
                                                                                    28.40466
                                                                        ],
                                                                        [
                                                                                    77.015105,
                                                                                    28.404498
                                                                        ],
                                                                        [
                                                                                    77.014928,
                                                                                    28.404335
                                                                        ],
                                                                        [
                                                                                    77.014753,
                                                                                    28.404169
                                                                        ],
                                                                        [
                                                                                    77.014581,
                                                                                    28.404001
                                                                        ],
                                                                        [
                                                                                    77.014411,
                                                                                    28.403832
                                                                        ],
                                                                        [
                                                                                    77.014243,
                                                                                    28.40366
                                                                        ],
                                                                        [
                                                                                    77.014078,
                                                                                    28.403487
                                                                        ],
                                                                        [
                                                                                    77.013916,
                                                                                    28.403312
                                                                        ],
                                                                        [
                                                                                    77.013756,
                                                                                    28.403135
                                                                        ],
                                                                        [
                                                                                    77.013598,
                                                                                    28.402957
                                                                        ],
                                                                        [
                                                                                    77.013443,
                                                                                    28.402776
                                                                        ],
                                                                        [
                                                                                    77.013291,
                                                                                    28.402594
                                                                        ],
                                                                        [
                                                                                    77.013141,
                                                                                    28.40241
                                                                        ],
                                                                        [
                                                                                    77.012994,
                                                                                    28.402225
                                                                        ],
                                                                        [
                                                                                    77.01285,
                                                                                    28.402038
                                                                        ],
                                                                        [
                                                                                    77.012708,
                                                                                    28.40185
                                                                        ],
                                                                        [
                                                                                    77.012569,
                                                                                    28.40166
                                                                        ],
                                                                        [
                                                                                    77.012433,
                                                                                    28.401468
                                                                        ],
                                                                        [
                                                                                    77.012299,
                                                                                    28.401275
                                                                        ],
                                                                        [
                                                                                    77.012168,
                                                                                    28.40108
                                                                        ],
                                                                        [
                                                                                    77.01204,
                                                                                    28.400884
                                                                        ],
                                                                        [
                                                                                    77.011915,
                                                                                    28.400687
                                                                        ],
                                                                        [
                                                                                    77.011793,
                                                                                    28.400488
                                                                        ],
                                                                        [
                                                                                    77.011673,
                                                                                    28.400288
                                                                        ],
                                                                        [
                                                                                    77.011557,
                                                                                    28.400087
                                                                        ],
                                                                        [
                                                                                    77.011443,
                                                                                    28.399884
                                                                        ],
                                                                        [
                                                                                    77.011332,
                                                                                    28.39968
                                                                        ],
                                                                        [
                                                                                    77.011224,
                                                                                    28.399475
                                                                        ],
                                                                        [
                                                                                    77.011119,
                                                                                    28.399269
                                                                        ],
                                                                        [
                                                                                    77.011017,
                                                                                    28.399061
                                                                        ],
                                                                        [
                                                                                    77.010918,
                                                                                    28.398853
                                                                        ],
                                                                        [
                                                                                    77.010822,
                                                                                    28.398643
                                                                        ],
                                                                        [
                                                                                    77.010729,
                                                                                    28.398433
                                                                        ],
                                                                        [
                                                                                    77.010639,
                                                                                    28.398221
                                                                        ],
                                                                        [
                                                                                    77.010552,
                                                                                    28.398008
                                                                        ],
                                                                        [
                                                                                    77.010468,
                                                                                    28.397795
                                                                        ],
                                                                        [
                                                                                    77.010387,
                                                                                    28.39758
                                                                        ],
                                                                        [
                                                                                    77.010309,
                                                                                    28.397365
                                                                        ],
                                                                        [
                                                                                    77.010234,
                                                                                    28.397148
                                                                        ],
                                                                        [
                                                                                    77.010163,
                                                                                    28.396931
                                                                        ],
                                                                        [
                                                                                    77.010094,
                                                                                    28.396714
                                                                        ],
                                                                        [
                                                                                    77.010029,
                                                                                    28.396495
                                                                        ],
                                                                        [
                                                                                    77.009966,
                                                                                    28.396276
                                                                        ],
                                                                        [
                                                                                    77.009907,
                                                                                    28.396056
                                                                        ],
                                                                        [
                                                                                    77.009851,
                                                                                    28.395835
                                                                        ],
                                                                        [
                                                                                    77.009798,
                                                                                    28.395614
                                                                        ],
                                                                        [
                                                                                    77.009748,
                                                                                    28.395392
                                                                        ],
                                                                        [
                                                                                    77.009702,
                                                                                    28.39517
                                                                        ],
                                                                        [
                                                                                    77.009658,
                                                                                    28.394947
                                                                        ],
                                                                        [
                                                                                    77.009618,
                                                                                    28.394724
                                                                        ],
                                                                        [
                                                                                    77.009581,
                                                                                    28.3945
                                                                        ],
                                                                        [
                                                                                    77.009547,
                                                                                    28.394276
                                                                        ],
                                                                        [
                                                                                    77.009517,
                                                                                    28.394052
                                                                        ],
                                                                        [
                                                                                    77.009489,
                                                                                    28.393827
                                                                        ],
                                                                        [
                                                                                    77.009465,
                                                                                    28.393602
                                                                        ],
                                                                        [
                                                                                    77.009444,
                                                                                    28.393377
                                                                        ],
                                                                        [
                                                                                    77.009427,
                                                                                    28.393151
                                                                        ],
                                                                        [
                                                                                    77.009412,
                                                                                    28.392926
                                                                        ],
                                                                        [
                                                                                    77.009401,
                                                                                    28.3927
                                                                        ],
                                                                        [
                                                                                    77.009393,
                                                                                    28.392474
                                                                        ],
                                                                        [
                                                                                    77.009388,
                                                                                    28.392248
                                                                        ],
                                                                        [
                                                                                    77.009386,
                                                                                    28.392022
                                                                        ],
                                                                        [
                                                                                    77.009388,
                                                                                    28.391796
                                                                        ],
                                                                        [
                                                                                    77.009393,
                                                                                    28.39157
                                                                        ],
                                                                        [
                                                                                    77.009401,
                                                                                    28.391344
                                                                        ],
                                                                        [
                                                                                    77.009412,
                                                                                    28.391118
                                                                        ],
                                                                        [
                                                                                    77.009427,
                                                                                    28.390893
                                                                        ],
                                                                        [
                                                                                    77.009444,
                                                                                    28.390667
                                                                        ],
                                                                        [
                                                                                    77.009465,
                                                                                    28.390442
                                                                        ],
                                                                        [
                                                                                    77.009489,
                                                                                    28.390217
                                                                        ],
                                                                        [
                                                                                    77.009517,
                                                                                    28.389992
                                                                        ],
                                                                        [
                                                                                    77.009547,
                                                                                    28.389768
                                                                        ],
                                                                        [
                                                                                    77.009581,
                                                                                    28.389544
                                                                        ],
                                                                        [
                                                                                    77.009618,
                                                                                    28.38932
                                                                        ],
                                                                        [
                                                                                    77.009658,
                                                                                    28.389097
                                                                        ],
                                                                        [
                                                                                    77.009702,
                                                                                    28.388874
                                                                        ],
                                                                        [
                                                                                    77.009748,
                                                                                    28.388652
                                                                        ],
                                                                        [
                                                                                    77.009798,
                                                                                    28.38843
                                                                        ],
                                                                        [
                                                                                    77.009851,
                                                                                    28.388209
                                                                        ],
                                                                        [
                                                                                    77.009907,
                                                                                    28.387988
                                                                        ],
                                                                        [
                                                                                    77.009966,
                                                                                    28.387768
                                                                        ],
                                                                        [
                                                                                    77.010029,
                                                                                    28.387549
                                                                        ],
                                                                        [
                                                                                    77.010094,
                                                                                    28.38733
                                                                        ],
                                                                        [
                                                                                    77.010163,
                                                                                    28.387113
                                                                        ],
                                                                        [
                                                                                    77.010234,
                                                                                    28.386896
                                                                        ],
                                                                        [
                                                                                    77.010309,
                                                                                    28.386679
                                                                        ],
                                                                        [
                                                                                    77.010387,
                                                                                    28.386464
                                                                        ],
                                                                        [
                                                                                    77.010468,
                                                                                    28.386249
                                                                        ],
                                                                        [
                                                                                    77.010552,
                                                                                    28.386036
                                                                        ],
                                                                        [
                                                                                    77.010639,
                                                                                    28.385823
                                                                        ],
                                                                        [
                                                                                    77.010729,
                                                                                    28.385611
                                                                        ],
                                                                        [
                                                                                    77.010822,
                                                                                    28.385401
                                                                        ],
                                                                        [
                                                                                    77.010918,
                                                                                    28.385191
                                                                        ],
                                                                        [
                                                                                    77.011017,
                                                                                    28.384983
                                                                        ],
                                                                        [
                                                                                    77.011119,
                                                                                    28.384775
                                                                        ],
                                                                        [
                                                                                    77.011224,
                                                                                    28.384569
                                                                        ],
                                                                        [
                                                                                    77.011332,
                                                                                    28.384364
                                                                        ],
                                                                        [
                                                                                    77.011443,
                                                                                    28.38416
                                                                        ],
                                                                        [
                                                                                    77.011557,
                                                                                    28.383957
                                                                        ],
                                                                        [
                                                                                    77.011673,
                                                                                    28.383756
                                                                        ],
                                                                        [
                                                                                    77.011793,
                                                                                    28.383556
                                                                        ],
                                                                        [
                                                                                    77.011915,
                                                                                    28.383357
                                                                        ],
                                                                        [
                                                                                    77.01204,
                                                                                    28.38316
                                                                        ],
                                                                        [
                                                                                    77.012168,
                                                                                    28.382964
                                                                        ],
                                                                        [
                                                                                    77.012299,
                                                                                    28.382769
                                                                        ],
                                                                        [
                                                                                    77.012433,
                                                                                    28.382576
                                                                        ],
                                                                        [
                                                                                    77.012569,
                                                                                    28.382384
                                                                        ],
                                                                        [
                                                                                    77.012708,
                                                                                    28.382194
                                                                        ],
                                                                        [
                                                                                    77.01285,
                                                                                    28.382006
                                                                        ],
                                                                        [
                                                                                    77.012994,
                                                                                    28.381819
                                                                        ],
                                                                        [
                                                                                    77.013141,
                                                                                    28.381634
                                                                        ],
                                                                        [
                                                                                    77.013291,
                                                                                    28.38145
                                                                        ],
                                                                        [
                                                                                    77.013443,
                                                                                    28.381268
                                                                        ],
                                                                        [
                                                                                    77.013598,
                                                                                    28.381087
                                                                        ],
                                                                        [
                                                                                    77.013756,
                                                                                    28.380909
                                                                        ],
                                                                        [
                                                                                    77.013916,
                                                                                    28.380732
                                                                        ],
                                                                        [
                                                                                    77.014078,
                                                                                    28.380557
                                                                        ],
                                                                        [
                                                                                    77.014243,
                                                                                    28.380384
                                                                        ],
                                                                        [
                                                                                    77.014411,
                                                                                    28.380212
                                                                        ],
                                                                        [
                                                                                    77.014581,
                                                                                    28.380043
                                                                        ],
                                                                        [
                                                                                    77.014753,
                                                                                    28.379875
                                                                        ],
                                                                        [
                                                                                    77.014928,
                                                                                    28.379709
                                                                        ],
                                                                        [
                                                                                    77.015105,
                                                                                    28.379546
                                                                        ],
                                                                        [
                                                                                    77.015284,
                                                                                    28.379384
                                                                        ],
                                                                        [
                                                                                    77.015466,
                                                                                    28.379224
                                                                        ],
                                                                        [
                                                                                    77.01565,
                                                                                    28.379066
                                                                        ],
                                                                        [
                                                                                    77.015836,
                                                                                    28.37891
                                                                        ],
                                                                        [
                                                                                    77.016024,
                                                                                    28.378757
                                                                        ],
                                                                        [
                                                                                    77.016215,
                                                                                    28.378605
                                                                        ],
                                                                        [
                                                                                    77.016408,
                                                                                    28.378456
                                                                        ],
                                                                        [
                                                                                    77.016602,
                                                                                    28.378308
                                                                        ],
                                                                        [
                                                                                    77.016799,
                                                                                    28.378163
                                                                        ],
                                                                        [
                                                                                    77.016998,
                                                                                    28.37802
                                                                        ],
                                                                        [
                                                                                    77.017199,
                                                                                    28.377879
                                                                        ],
                                                                        [
                                                                                    77.017402,
                                                                                    28.377741
                                                                        ],
                                                                        [
                                                                                    77.017607,
                                                                                    28.377605
                                                                        ],
                                                                        [
                                                                                    77.017814,
                                                                                    28.377471
                                                                        ],
                                                                        [
                                                                                    77.018023,
                                                                                    28.377339
                                                                        ],
                                                                        [
                                                                                    77.018234,
                                                                                    28.37721
                                                                        ],
                                                                        [
                                                                                    77.018446,
                                                                                    28.377083
                                                                        ],
                                                                        [
                                                                                    77.018661,
                                                                                    28.376958
                                                                        ],
                                                                        [
                                                                                    77.018877,
                                                                                    28.376836
                                                                        ],
                                                                        [
                                                                                    77.019094,
                                                                                    28.376716
                                                                        ],
                                                                        [
                                                                                    77.019314,
                                                                                    28.376598
                                                                        ],
                                                                        [
                                                                                    77.019535,
                                                                                    28.376483
                                                                        ],
                                                                        [
                                                                                    77.019758,
                                                                                    28.37637
                                                                        ],
                                                                        [
                                                                                    77.019982,
                                                                                    28.37626
                                                                        ],
                                                                        [
                                                                                    77.020208,
                                                                                    28.376153
                                                                        ],
                                                                        [
                                                                                    77.020436,
                                                                                    28.376048
                                                                        ],
                                                                        [
                                                                                    77.020664,
                                                                                    28.375945
                                                                        ],
                                                                        [
                                                                                    77.020895,
                                                                                    28.375845
                                                                        ],
                                                                        [
                                                                                    77.021127,
                                                                                    28.375747
                                                                        ],
                                                                        [
                                                                                    77.02136,
                                                                                    28.375652
                                                                        ],
                                                                        [
                                                                                    77.021594,
                                                                                    28.37556
                                                                        ],
                                                                        [
                                                                                    77.02183,
                                                                                    28.37547
                                                                        ],
                                                                        [
                                                                                    77.022067,
                                                                                    28.375383
                                                                        ],
                                                                        [
                                                                                    77.022305,
                                                                                    28.375299
                                                                        ],
                                                                        [
                                                                                    77.022545,
                                                                                    28.375217
                                                                        ],
                                                                        [
                                                                                    77.022786,
                                                                                    28.375138
                                                                        ],
                                                                        [
                                                                                    77.023027,
                                                                                    28.375061
                                                                        ],
                                                                        [
                                                                                    77.02327,
                                                                                    28.374987
                                                                        ],
                                                                        [
                                                                                    77.023514,
                                                                                    28.374916
                                                                        ],
                                                                        [
                                                                                    77.023759,
                                                                                    28.374847
                                                                        ],
                                                                        [
                                                                                    77.024005,
                                                                                    28.374782
                                                                        ],
                                                                        [
                                                                                    77.024251,
                                                                                    28.374719
                                                                        ],
                                                                        [
                                                                                    77.024499,
                                                                                    28.374658
                                                                        ],
                                                                        [
                                                                                    77.024747,
                                                                                    28.374601
                                                                        ],
                                                                        [
                                                                                    77.024997,
                                                                                    28.374546
                                                                        ],
                                                                        [
                                                                                    77.025247,
                                                                                    28.374494
                                                                        ],
                                                                        [
                                                                                    77.025497,
                                                                                    28.374444
                                                                        ],
                                                                        [
                                                                                    77.025749,
                                                                                    28.374398
                                                                        ],
                                                                        [
                                                                                    77.026001,
                                                                                    28.374354
                                                                        ],
                                                                        [
                                                                                    77.026254,
                                                                                    28.374313
                                                                        ],
                                                                        [
                                                                                    77.026507,
                                                                                    28.374275
                                                                        ],
                                                                        [
                                                                                    77.026761,
                                                                                    28.37424
                                                                        ],
                                                                        [
                                                                                    77.027015,
                                                                                    28.374207
                                                                        ],
                                                                        [
                                                                                    77.027269,
                                                                                    28.374177
                                                                        ],
                                                                        [
                                                                                    77.027525,
                                                                                    28.37415
                                                                        ],
                                                                        [
                                                                                    77.02778,
                                                                                    28.374126
                                                                        ],
                                                                        [
                                                                                    77.028036,
                                                                                    28.374105
                                                                        ],
                                                                        [
                                                                                    77.028292,
                                                                                    28.374087
                                                                        ],
                                                                        [
                                                                                    77.028548,
                                                                                    28.374071
                                                                        ],
                                                                        [
                                                                                    77.028805,
                                                                                    28.374058
                                                                        ],
                                                                        [
                                                                                    77.029061,
                                                                                    28.374048
                                                                        ],
                                                                        [
                                                                                    77.029318,
                                                                                    28.374041
                                                                        ],
                                                                        [
                                                                                    77.029575,
                                                                                    28.374037
                                                                        ],
                                                                        [
                                                                                    77.029832,
                                                                                    28.374036
                                                                        ],
                                                                        [
                                                                                    77.030089,
                                                                                    28.374037
                                                                        ],
                                                                        [
                                                                                    77.030346,
                                                                                    28.374041
                                                                        ],
                                                                        [
                                                                                    77.030603,
                                                                                    28.374048
                                                                        ],
                                                                        [
                                                                                    77.030859,
                                                                                    28.374058
                                                                        ],
                                                                        [
                                                                                    77.031116,
                                                                                    28.374071
                                                                        ],
                                                                        [
                                                                                    77.031372,
                                                                                    28.374087
                                                                        ],
                                                                        [
                                                                                    77.031628,
                                                                                    28.374105
                                                                        ],
                                                                        [
                                                                                    77.031884,
                                                                                    28.374126
                                                                        ],
                                                                        [
                                                                                    77.032139,
                                                                                    28.37415
                                                                        ],
                                                                        [
                                                                                    77.032395,
                                                                                    28.374177
                                                                        ],
                                                                        [
                                                                                    77.032649,
                                                                                    28.374207
                                                                        ],
                                                                        [
                                                                                    77.032903,
                                                                                    28.37424
                                                                        ],
                                                                        [
                                                                                    77.033157,
                                                                                    28.374275
                                                                        ],
                                                                        [
                                                                                    77.03341,
                                                                                    28.374313
                                                                        ],
                                                                        [
                                                                                    77.033663,
                                                                                    28.374354
                                                                        ],
                                                                        [
                                                                                    77.033915,
                                                                                    28.374398
                                                                        ],
                                                                        [
                                                                                    77.034167,
                                                                                    28.374444
                                                                        ],
                                                                        [
                                                                                    77.034417,
                                                                                    28.374494
                                                                        ],
                                                                        [
                                                                                    77.034667,
                                                                                    28.374546
                                                                        ],
                                                                        [
                                                                                    77.034917,
                                                                                    28.374601
                                                                        ],
                                                                        [
                                                                                    77.035165,
                                                                                    28.374658
                                                                        ],
                                                                        [
                                                                                    77.035413,
                                                                                    28.374719
                                                                        ],
                                                                        [
                                                                                    77.035659,
                                                                                    28.374782
                                                                        ],
                                                                        [
                                                                                    77.035905,
                                                                                    28.374847
                                                                        ],
                                                                        [
                                                                                    77.03615,
                                                                                    28.374916
                                                                        ],
                                                                        [
                                                                                    77.036394,
                                                                                    28.374987
                                                                        ],
                                                                        [
                                                                                    77.036637,
                                                                                    28.375061
                                                                        ],
                                                                        [
                                                                                    77.036878,
                                                                                    28.375138
                                                                        ],
                                                                        [
                                                                                    77.037119,
                                                                                    28.375217
                                                                        ],
                                                                        [
                                                                                    77.037359,
                                                                                    28.375299
                                                                        ],
                                                                        [
                                                                                    77.037597,
                                                                                    28.375383
                                                                        ],
                                                                        [
                                                                                    77.037834,
                                                                                    28.37547
                                                                        ],
                                                                        [
                                                                                    77.03807,
                                                                                    28.37556
                                                                        ],
                                                                        [
                                                                                    77.038304,
                                                                                    28.375652
                                                                        ],
                                                                        [
                                                                                    77.038537,
                                                                                    28.375747
                                                                        ],
                                                                        [
                                                                                    77.038769,
                                                                                    28.375845
                                                                        ],
                                                                        [
                                                                                    77.039,
                                                                                    28.375945
                                                                        ],
                                                                        [
                                                                                    77.039228,
                                                                                    28.376048
                                                                        ],
                                                                        [
                                                                                    77.039456,
                                                                                    28.376153
                                                                        ],
                                                                        [
                                                                                    77.039682,
                                                                                    28.37626
                                                                        ],
                                                                        [
                                                                                    77.039906,
                                                                                    28.37637
                                                                        ],
                                                                        [
                                                                                    77.040129,
                                                                                    28.376483
                                                                        ],
                                                                        [
                                                                                    77.04035,
                                                                                    28.376598
                                                                        ],
                                                                        [
                                                                                    77.04057,
                                                                                    28.376716
                                                                        ],
                                                                        [
                                                                                    77.040787,
                                                                                    28.376836
                                                                        ],
                                                                        [
                                                                                    77.041003,
                                                                                    28.376958
                                                                        ],
                                                                        [
                                                                                    77.041218,
                                                                                    28.377083
                                                                        ],
                                                                        [
                                                                                    77.04143,
                                                                                    28.37721
                                                                        ],
                                                                        [
                                                                                    77.041641,
                                                                                    28.377339
                                                                        ],
                                                                        [
                                                                                    77.04185,
                                                                                    28.377471
                                                                        ],
                                                                        [
                                                                                    77.042057,
                                                                                    28.377605
                                                                        ],
                                                                        [
                                                                                    77.042262,
                                                                                    28.377741
                                                                        ],
                                                                        [
                                                                                    77.042465,
                                                                                    28.377879
                                                                        ],
                                                                        [
                                                                                    77.042666,
                                                                                    28.37802
                                                                        ],
                                                                        [
                                                                                    77.042865,
                                                                                    28.378163
                                                                        ],
                                                                        [
                                                                                    77.043062,
                                                                                    28.378308
                                                                        ],
                                                                        [
                                                                                    77.043256,
                                                                                    28.378456
                                                                        ],
                                                                        [
                                                                                    77.043449,
                                                                                    28.378605
                                                                        ],
                                                                        [
                                                                                    77.04364,
                                                                                    28.378757
                                                                        ],
                                                                        [
                                                                                    77.043828,
                                                                                    28.37891
                                                                        ],
                                                                        [
                                                                                    77.044014,
                                                                                    28.379066
                                                                        ],
                                                                        [
                                                                                    77.044198,
                                                                                    28.379224
                                                                        ],
                                                                        [
                                                                                    77.04438,
                                                                                    28.379384
                                                                        ],
                                                                        [
                                                                                    77.044559,
                                                                                    28.379546
                                                                        ],
                                                                        [
                                                                                    77.044736,
                                                                                    28.379709
                                                                        ],
                                                                        [
                                                                                    77.044911,
                                                                                    28.379875
                                                                        ],
                                                                        [
                                                                                    77.045083,
                                                                                    28.380043
                                                                        ],
                                                                        [
                                                                                    77.045253,
                                                                                    28.380212
                                                                        ],
                                                                        [
                                                                                    77.045421,
                                                                                    28.380384
                                                                        ],
                                                                        [
                                                                                    77.045586,
                                                                                    28.380557
                                                                        ],
                                                                        [
                                                                                    77.045748,
                                                                                    28.380732
                                                                        ],
                                                                        [
                                                                                    77.045908,
                                                                                    28.380909
                                                                        ],
                                                                        [
                                                                                    77.046066,
                                                                                    28.381087
                                                                        ],
                                                                        [
                                                                                    77.046221,
                                                                                    28.381268
                                                                        ],
                                                                        [
                                                                                    77.046373,
                                                                                    28.38145
                                                                        ],
                                                                        [
                                                                                    77.046523,
                                                                                    28.381634
                                                                        ],
                                                                        [
                                                                                    77.04667,
                                                                                    28.381819
                                                                        ],
                                                                        [
                                                                                    77.046814,
                                                                                    28.382006
                                                                        ],
                                                                        [
                                                                                    77.046956,
                                                                                    28.382194
                                                                        ],
                                                                        [
                                                                                    77.047095,
                                                                                    28.382384
                                                                        ],
                                                                        [
                                                                                    77.047231,
                                                                                    28.382576
                                                                        ],
                                                                        [
                                                                                    77.047365,
                                                                                    28.382769
                                                                        ],
                                                                        [
                                                                                    77.047496,
                                                                                    28.382964
                                                                        ],
                                                                        [
                                                                                    77.047624,
                                                                                    28.38316
                                                                        ],
                                                                        [
                                                                                    77.047749,
                                                                                    28.383357
                                                                        ],
                                                                        [
                                                                                    77.047871,
                                                                                    28.383556
                                                                        ],
                                                                        [
                                                                                    77.047991,
                                                                                    28.383756
                                                                        ],
                                                                        [
                                                                                    77.048107,
                                                                                    28.383957
                                                                        ],
                                                                        [
                                                                                    77.048221,
                                                                                    28.38416
                                                                        ],
                                                                        [
                                                                                    77.048332,
                                                                                    28.384364
                                                                        ],
                                                                        [
                                                                                    77.04844,
                                                                                    28.384569
                                                                        ],
                                                                        [
                                                                                    77.048545,
                                                                                    28.384775
                                                                        ],
                                                                        [
                                                                                    77.048647,
                                                                                    28.384983
                                                                        ],
                                                                        [
                                                                                    77.048746,
                                                                                    28.385191
                                                                        ],
                                                                        [
                                                                                    77.048842,
                                                                                    28.385401
                                                                        ],
                                                                        [
                                                                                    77.048935,
                                                                                    28.385611
                                                                        ],
                                                                        [
                                                                                    77.049025,
                                                                                    28.385823
                                                                        ],
                                                                        [
                                                                                    77.049112,
                                                                                    28.386036
                                                                        ],
                                                                        [
                                                                                    77.049196,
                                                                                    28.386249
                                                                        ],
                                                                        [
                                                                                    77.049277,
                                                                                    28.386464
                                                                        ],
                                                                        [
                                                                                    77.049355,
                                                                                    28.386679
                                                                        ],
                                                                        [
                                                                                    77.04943,
                                                                                    28.386896
                                                                        ],
                                                                        [
                                                                                    77.049501,
                                                                                    28.387113
                                                                        ],
                                                                        [
                                                                                    77.04957,
                                                                                    28.38733
                                                                        ],
                                                                        [
                                                                                    77.049635,
                                                                                    28.387549
                                                                        ],
                                                                        [
                                                                                    77.049698,
                                                                                    28.387768
                                                                        ],
                                                                        [
                                                                                    77.049757,
                                                                                    28.387988
                                                                        ],
                                                                        [
                                                                                    77.049813,
                                                                                    28.388209
                                                                        ],
                                                                        [
                                                                                    77.049866,
                                                                                    28.38843
                                                                        ],
                                                                        [
                                                                                    77.049916,
                                                                                    28.388652
                                                                        ],
                                                                        [
                                                                                    77.049962,
                                                                                    28.388874
                                                                        ],
                                                                        [
                                                                                    77.050006,
                                                                                    28.389097
                                                                        ],
                                                                        [
                                                                                    77.050046,
                                                                                    28.38932
                                                                        ],
                                                                        [
                                                                                    77.050083,
                                                                                    28.389544
                                                                        ],
                                                                        [
                                                                                    77.050117,
                                                                                    28.389768
                                                                        ],
                                                                        [
                                                                                    77.050147,
                                                                                    28.389992
                                                                        ],
                                                                        [
                                                                                    77.050175,
                                                                                    28.390217
                                                                        ],
                                                                        [
                                                                                    77.050199,
                                                                                    28.390442
                                                                        ],
                                                                        [
                                                                                    77.05022,
                                                                                    28.390667
                                                                        ],
                                                                        [
                                                                                    77.050237,
                                                                                    28.390893
                                                                        ],
                                                                        [
                                                                                    77.050252,
                                                                                    28.391118
                                                                        ],
                                                                        [
                                                                                    77.050263,
                                                                                    28.391344
                                                                        ],
                                                                        [
                                                                                    77.050271,
                                                                                    28.39157
                                                                        ],
                                                                        [
                                                                                    77.050276,
                                                                                    28.391796
                                                                        ],
                                                                        [
                                                                                    77.050278,
                                                                                    28.392022
                                                                        ]
                                                            ]
                                                ]
                                    }
                        }
            ]
};
        
        // Competitor variables
        let competitorsLayer = null;
        let competitorsVisible = false;
        
        // GPKG layer variables
        let gpkgLayer = null;
        let gpkgVisible = false;
        
        // Competitor brand colors - will be built dynamically from CSV data
        let competitorColors = {};
        
        // Build color mapping from competitors data
        function buildCompetitorColors() {
            competitorColors = {};
            competitorsData.forEach(competitor => {
                const name = competitor.Name;
                const color = competitor.color;
                if (name && color) {
                    competitorColors[name] = color;
                }
            });
            console.log('Competitor colors loaded:', competitorColors);
        }
        
        function loadData() {
            csvData = csvDataset;
            console.log(`Successfully loaded ${csvData.length} locations from embedded dataset`);
            console.log(`Successfully loaded ${poiData.length} POI records from embedded dataset`);
            
            // Build competitor colors dynamically from data
            buildCompetitorColors();
            
                // ===== DEBUG CODE - ADD THIS =====
            if (csvData.length > 0) {
                console.log('=== FOOTFALL CSV DEBUG ===');
                console.log('All column names:', Object.keys(csvData[0]));
                console.log('Sample row:', csvData[0]);
                
                // Check for footfall-related columns
                const footfallColumns = Object.keys(csvData[0]).filter(key => 
                    key.toLowerCase().includes('inr') || 
                    key.toLowerCase().includes('lsi') || 
                    key.toLowerCase().includes('footfall')
                );
                console.log('Footfall-related columns:', footfallColumns);
                
                // Show exact column names with quotes to see spaces
                footfallColumns.forEach(col => {
                    console.log(`Column: "${col}" = ${csvData[0][col]}`);
                });
            }
            // ===== END DEBUG CODE =====
    
            // Debug POI data structure
            if (poiData.length > 0) {
                console.log('POI data sample:', poiData[0]);
                console.log('POI location field variations:', {
                    location: poiData[0].location,
                    'Location ': poiData[0]['Location '],
                    'Location': poiData[0]['Location']
                });
                console.log('POI pincode field variations:', {
                    pincode: poiData[0].pincode,
                    'Pincode': poiData[0]['Pincode'],
                    'Pincode ': poiData[0]['Pincode '],
                    'PINCODE': poiData[0]['PINCODE']
                });
                
                // Get unique locations from POI data
                const poiLocations = [...new Set(poiData.map(poi => 
                    poi.location || poi['Location '] || poi['Location'] || 'Unknown'
                ))];
                console.log(`POI data covers ${poiLocations.length} unique locations`);
                console.log('Sample POI locations:', poiLocations.slice(0, 5));
                
                // Get unique pincodes from POI data
                const poiPincodes = [...new Set(poiData.map(poi => 
                    poi.pincode || poi.Pincode || poi['Pincode '] || poi.PINCODE || 'Unknown'
                ))];
                console.log(`POI data covers ${poiPincodes.length} unique pincodes`);
                console.log('Sample POI pincodes:', poiPincodes.slice(0, 5));
                
                // Get unique locations from main dataset
                const mainLocations = [...new Set(csvData.map(row => row['Location ']))];
                console.log(`Main data covers ${mainLocations.length} unique locations`);
                console.log('Sample main locations:', mainLocations.slice(0, 5));
                
                // Get unique pincodes from main dataset
                const mainPincodes = [...new Set(csvData.map(row => row.pincode))];
                console.log(`Main data covers ${mainPincodes.length} unique pincodes`);
                console.log('Sample main pincodes:', mainPincodes.slice(0, 5));
            }
            
            // Initialize tab visibility
            initializeTabVisibility();
            initLocationsMap();
            populateLocationDropdown();
            if (csvData.length > 0) {
                const firstIdentifier = filterType === 'pincode' ? csvData[0].pincode : csvData[0]['Location '];
                updateLocation(firstIdentifier);
            }
        }
        
        function initializeTabVisibility() {
            const footfallTab = document.getElementById('footfallTab');
            const poiTab = document.getElementById('poiTab');
            
            console.log('Initializing tab visibility...');
            
            // Always make POI tab visible
            if (poiTab) {
                poiTab.style.display = 'inline-block';
                console.log('POI tab initialized as visible');
            }
            
            // Set footfall tab based on initial filter type
            if (footfallTab) {
                if (filterType === 'location') {
                    footfallTab.style.display = 'inline-block';
                    console.log('Footfall tab initialized as visible (location mode)');
                } else {
                    footfallTab.style.display = 'inline-block';
                    console.log('Footfall tab initialized as hidden (pincode mode)');
                }
            }
        }

        function changeFilterType(newFilterType) {
            console.log('changeFilterType called with:', newFilterType);
            
            if (newFilterType) {
                filterType = newFilterType;
            } else {
                filterType = document.getElementById('filterType').value;
            }
            
            const pincodeTab = document.getElementById('pincodeTab');
            const locationTab = document.getElementById('locationTab');
            
            if (filterType === 'pincode') {
                pincodeTab.style.background = '#3ec1bd';
                pincodeTab.style.color = 'white';
                pincodeTab.classList.add('active');
                locationTab.style.background = 'white';
                locationTab.style.color = '#3ec1bd';
                locationTab.classList.remove('active');
            } else {
                pincodeTab.style.background = 'white';
                pincodeTab.style.color = '#3ec1bd';
                pincodeTab.classList.remove('active');
                locationTab.style.background = '#3ec1bd';
                locationTab.style.color = 'white';
                locationTab.classList.add('active');
            }
            
            // Force update tab visibility after filter change
            populateLocationDropdown();
            
            const firstOption = document.getElementById('locationSelect').options[1];
            if (firstOption) {
                document.getElementById('locationSelect').value = firstOption.value;
                updateLocation(firstOption.value);
            }
        }

        function populateLocationDropdown() {
            const select = document.getElementById('locationSelect');
            select.innerHTML = '<option value="">Select a location...</option>';
            
            // Get tab references
            const footfallTab = document.getElementById('footfallTab');
            const poiTab = document.getElementById('poiTab');
            
            console.log(`Setting tab visibility for filterType: ${filterType}`);
            
            
            // Always show POI tab for both pincode and location levels
            if (poiTab) {
                poiTab.style.display = 'inline-block';
            }
            
            if (footfallTab) {
                footfallTab.style.display = 'inline-block';
            }
            
        
            
            console.log('POI tab display:', poiTab ? poiTab.style.display : 'not found');
            console.log('Footfall tab display:', footfallTab ? footfallTab.style.display : 'not found');
            
            // Populate dropdown options based on filter type
            if (filterType === 'pincode') {
                csvData.forEach(row => {
                    const option = document.createElement('option');
                    option.value = row.pincode;
                    option.textContent = `${row.pincode} - ${row['Location '] || 'Unknown Location'}`;
                    select.appendChild(option);
                });
            } else {
                const locationGroups = {};
                csvData.forEach(row => {
                    const locationName = row['Location '];
                    if (locationName) {
                        if (!locationGroups[locationName]) {
                            locationGroups[locationName] = [];
                        }
                        locationGroups[locationName].push(row.pincode);
                    }
                });
                
                Object.entries(locationGroups).forEach(([locationName, pincodes]) => {
                    const option = document.createElement('option');
                    option.value = locationName;
                    const pincodeCount = '';
                    const pincodeText = '';
                    option.textContent = `${locationName}`;
                    select.appendChild(option);
                });
            }
        }

        function aggregateLocationData(locationName) {
            const locationRows = csvData.filter(row => row['Location '] === locationName);
            
            if (locationRows.length === 0) return null;
            if (locationRows.length === 1) return locationRows[0];
            
            const aggregated = { ...locationRows[0] };
            aggregated['Location '] = locationName;
            aggregated.pincode = locationRows.map(row => row.pincode).join(' + ');
            
            const totalWeightedIncome = locationRows.reduce((sum, row) => 
                sum + ((row.avg_monthly_income || 0) * (row.catchment_households || 0)), 0
            );
            const totalHouseholds = locationRows.reduce((sum, row) => sum + (row.catchment_households || 0), 0);
            aggregated.avg_monthly_income = totalHouseholds > 0 ? Math.round(totalWeightedIncome / totalHouseholds) : 0;
            
            // For footfall data - use the original values from first matching row since footfall CSV is already location-level
const footfallRow = locationRows.find(row => row['footfall_index'] && row['footfall_index'] > 0);
if (footfallRow) {
    // Copy footfall data directly without aggregation
    aggregated['footfall_index'] = footfallRow['footfall_index'];
    aggregated['unique_visitor_index'] = footfallRow['unique_visitor_index'] || 0;
    
    // ESI fields - exact column names from debug output
    aggregated['Low INR <20,000'] = footfallRow['Low INR <20,000'] || 0;
    aggregated['Medium Low INR 20,000   40,000'] = footfallRow['Medium Low INR 20,000   40,000'] || 0;
    aggregated['Medium INR 40,000   80,000'] = footfallRow['Medium INR 40,000   80,000'] || 0;
    aggregated['Medium Good INR 80,000   1,30,000'] = footfallRow['Medium Good INR 80,000   1,30,000'] || 0;
    aggregated['Good INR 1,30,000   1,70,000'] = footfallRow['Good INR 1,30,000   1,70,000'] || 0;
    aggregated['Very Good INR 1,70,000   2,30,000'] = footfallRow['Very Good INR 1,70,000   2,30,000'] || 0;
    aggregated['High INR 2,30,000   3,00,000'] = footfallRow['High INR 2,30,000   3,00,000'] || 0;
    aggregated['Very High INR > 3,00,000'] = footfallRow['Very High INR > 3,00,000'] || 0;
    
    // LSI fields - exact column names from debug output
    aggregated['LSI 01: Urban Established Elite'] = footfallRow['LSI 01: Urban Established Elite'] || 0;
    aggregated['LSI 02: Urban New Wealth'] = footfallRow['LSI 02: Urban New Wealth'] || 0;
    aggregated['LSI 03: Aspiring Urban Middle Class'] = footfallRow['LSI 03: Aspiring Urban Middle Class'] || 0;
    aggregated['LSI 04: Conservative Urban Middle Class'] = footfallRow['LSI 04: Conservative Urban Middle Class'] || 0;
    aggregated['LSI 05: Successful Urban Fast Climbers'] = footfallRow['LSI 05: Successful Urban Fast Climbers'] || 0;
    aggregated['LSI 06: Upcoming Urban Climbers'] = footfallRow['LSI 06: Upcoming Urban Climbers'] || 0;
    aggregated['LSI 07: Striving Urban Climbers'] = footfallRow['LSI 07: Striving Urban Climbers'] || 0;
    aggregated['LSI 08: Urban Dependants'] = footfallRow['LSI 08: Urban Dependants'] || 0;
    aggregated['LSI 09: Daily Urban Survivors'] = footfallRow['LSI 09: Daily Urban Survivors'] || 0;
} else {
    // If no footfall data found, set to 0
    aggregated['footfall_index'] = 0;
    aggregated['unique_visitor_index'] = 0;
    
    // ESI fields
    aggregated['Low INR <20,000'] = 0;
    aggregated['Medium Low INR 20,000   40,000'] = 0;
    aggregated['Medium INR 40,000   80,000'] = 0;
    aggregated['Medium Good INR 80,000   1,30,000'] = 0;
    aggregated['Good INR 1,30,000   1,70,000'] = 0;
    aggregated['Very Good INR 1,70,000   2,30,000'] = 0;
    aggregated['High INR 2,30,000   3,00,000'] = 0;
    aggregated['Very High INR > 3,00,000'] = 0;
    
    // LSI fields
    aggregated['LSI 01: Urban Established Elite'] = 0;
    aggregated['LSI 02: Urban New Wealth'] = 0;
    aggregated['LSI 03: Aspiring Urban Middle Class'] = 0;
    aggregated['LSI 04: Conservative Urban Middle Class'] = 0;
    aggregated['LSI 05: Successful Urban Fast Climbers'] = 0;
    aggregated['LSI 06: Upcoming Urban Climbers'] = 0;
    aggregated['LSI 07: Striving Urban Climbers'] = 0;
    aggregated['LSI 08: Urban Dependants'] = 0;
    aggregated['LSI 09: Daily Urban Survivors'] = 0;
}
            
            // Spending fields - calculate weighted averages
            const spendingFields = [
                'spend_housing',
                'spend_food_fmcg',
                'spend_apparel',
                'spend_transportation',
                'spend_healthcare_medical',
                'spend_financial_savings',
                'spend_education',
                'spend_entertainment'
            ];
            
            // Calculate weighted average for each spending category
            spendingFields.forEach(field => {
                const totalWeightedSpend = locationRows.reduce((sum, row) => 
                    sum + ((row[field] || 0) * (row.catchment_households || 0)), 0
                );
                const avgSpend = totalHouseholds > 0 ? totalWeightedSpend / totalHouseholds : 0;
                aggregated[field] = Math.round(avgSpend / 100) * 100; // Round to nearest 100
            });
            
            // Recalculate spend_others to ensure sum equals avg_monthly_income
            const sumOfOtherSpends = spendingFields.reduce((sum, field) => sum + (aggregated[field] || 0), 0);
            const calculatedOthers = aggregated.avg_monthly_income - sumOfOtherSpends;
            aggregated.spend_others = Math.max(0, Math.round(calculatedOthers / 100) * 100);
            
            // Other numeric fields use simple sum
            const numericFields = Object.keys(locationRows[0]).filter(key => 
                key !== 'pincode' && 
                key !== 'Location ' && 
                key !== 'avg_monthly_income' && 
                key !== 'spend_others' &&
                key !== 'Footfall_index' &&
                !key.startsWith('ESI ') &&
                !key.startsWith('LSI ') &&
                !spendingFields.includes(key) &&
                typeof locationRows[0][key] === 'number'
            );
            
            numericFields.forEach(field => {
                aggregated[field] = locationRows.reduce((sum, row) => sum + (row[field] || 0), 0);
            });
            
            return aggregated;
        }

        function updateLocation(identifier) {
            if (!identifier) {
                identifier = document.getElementById('locationSelect').value;
            }
            
            if (!identifier) return;
            
            let locationData;
            
            if (filterType === 'pincode') {
                locationData = csvData.find(row => row.pincode == identifier);
                if (!locationData) return;
            } else {
                locationData = aggregateLocationData(identifier);
                if (!locationData) return;
            }
            
            currentLocationData = processLocationData(locationData);
            
            if (filterType === 'pincode') {
                document.getElementById('storeName').textContent = locationData['Location '] || 'Unknown Location';
                document.getElementById('storeDetails').textContent = `Pincode: ${locationData.pincode}`;
            } else {
                document.getElementById('storeName').textContent = locationData['Location '] || 'Unknown Location';
                const pincodes = csvData.filter(row => row['Location '] === identifier).map(row => row.pincode);
                document.getElementById('storeDetails').textContent = `Store ID: ${pincodes.join(', ')}`;
            }
            
            document.getElementById('locationSelect').value = identifier;
            
            updateOverviewTab();
            clearCharts();
            
            // Reset chart flags and reinitialize current tab
            window.chartFlags = {};
            
            // Find which tab is currently active and reinitialize it
            const activeTab = document.querySelector('.tab.active');
            if (activeTab) {
                const tabText = activeTab.textContent.trim();
                if (tabText.includes('Footfall')) {
                    initFootfallAnalysis();
                    window.chartFlags.footfall = true;
                } else if (tabText.includes('POI Deep Dive')) {
                    initPOIAnalysis();
                    window.chartFlags.poi = true;
                } else if (tabText.includes('Income')) {
                    initIncomeChart();
                    window.chartFlags.income = true;
                } else if (tabText.includes('Lifestyle')) {
                    initLifestyleChart();
                    window.chartFlags.lifestyle = true;
                } else if (tabText.includes('Spending')) {
                    initBarChart('spending', currentLocationData.spending, 'spendingChart', 'spendingBreakdown');
                    window.chartFlags.spending = true;
                } else if (tabText.includes('Education')) {
                    initBarChart('education', currentLocationData.education, 'educationChart', 'educationBreakdown');
                    window.chartFlags.education = true;
                } else if (tabText.includes('Occupation')) {
                    initBarChart('occupation', currentLocationData.occupation, 'occupationChart', 'occupationBreakdown');
                    window.chartFlags.occupation = true;
                } else if (tabText.includes('Banking')) {
                    initProducts('banking', currentLocationData.banking);
                    window.chartFlags.banking = true;
                } else if (tabText.includes('FMCG')) {
                    initProducts('fmcg', currentLocationData.fmcg);
                    window.chartFlags.fmcg = true;
                } else if (tabText.includes('Fashion')) {
                    initBarChart('fashion', currentLocationData.fashion, 'fashionChart', 'fashionBreakdown');
                    window.chartFlags.fashion = true;
                } else if (tabText.includes('Jewellery')) {
                    initProducts('jewellery', currentLocationData.jewellery);
                    window.chartFlags.jewellery = true;
                } else if (tabText.includes('Real Estate')) {
                    initBarChart('realestate', currentLocationData.realestate, 'realestateChart', 'realestateBreakdown');
                    window.chartFlags.realestate = true;
                } else if (tabText.includes('Retail')) {
                    initProducts('retail', currentLocationData.retail);
                    window.chartFlags.retail = true;
                } else if (tabText.includes('Travel')) {
                    initProducts('travel', currentLocationData.travel);
                    window.chartFlags.travel = true;
                } else if (tabText.includes('Two Wheeler')) {
                    initBarChart('twowheeler', currentLocationData.twowheeler, 'twowheelerChart', 'twowheelerBreakdown');
                    window.chartFlags.twowheeler = true;
                } else if (tabText.includes('Automobile')) {
                    initBarChart('automobile', currentLocationData.automobile, 'automobileChart', 'automobileBreakdown');
                    window.chartFlags.automobile = true;
                }
            }
        }

        function processLocationData(row) {
            const totalHouseholds = row.catchment_households || 0;
            const totalPopulation = row.total_number_of_population || 0;
            
            const incomeSegments = [
                { label: "‚Çπ0 - ‚Çπ20,000", value: row.hh_0_to_20k || 0 },
                { label: "‚Çπ20,000 - ‚Çπ40,000", value: row.hh_20k_to_40k || 0 },
                { label: "‚Çπ40,000 - ‚Çπ80,000", value: row.hh_40k_to_80k || 0 },
                { label: "‚Çπ80,000 - ‚Çπ1,20,000", value: row.hh_80k_to_120k || 0 },
                { label: "‚Çπ1,20,000 - ‚Çπ1,60,000", value: row.hh_120k_to_160k || 0 },
                { label: "‚Çπ1,60,000 - ‚Çπ2,00,000", value: row.hh_160_to_200k || 0 },
                { label: "‚Çπ2,00,000 - ‚Çπ2,50,000", value: row.hh_200k_to_250k || 0 },
                { label: "‚Çπ2,50,000 - ‚Çπ3,00,000", value: row.hh_250k_to_300k || 0 },
                { label: "‚Çπ3,00,000 - ‚Çπ4,00,000", value: row.hh_300k_to_400k || 0 },
                { label: "‚Çπ4,00,000+", value: row.hh_400k_to_inf || 0 }
            ].map(segment => ({
                ...segment,
                count: segment.value,
                percentage: totalHouseholds > 0 ? ((segment.value / totalHouseholds) * 100).toFixed(1) : 0
            }));            
            
            const lifestyleSegments = [
                { label: "Established Elite (LSI-01)", value: row.lsi_01 || 0 },
                { label: "Affluent New Wealth (LSI-02)", value: row.lsi_02 || 0 },
                { label: "Aspiring Middle Class (LSI-03)", value: row.lsi_03 || 0 },
                { label: "Conservative Middle Class (LSI-04)", value: row.lsi_04 || 0 },
                { label: "Successful Runner Up's (LSI-05)", value: row.lsi_05 || 0 },
                { label: "Urban Climbers (LSI-06)", value: row.lsi_06 || 0 },
                { label: "Struggling Climbers (LSI-07)", value: row.lsi_07 || 0 },
                { label: "Trailers (LSI-08)", value: row.lsi_08 || 0 },
                { label: "Dependants (LSI-09)", value: row.lsi_09 || 0 },
                { label: "Down the Road (LSI-10)", value: row.lsi_10 || 0 },
                { label: "Daily Survivors (LSI-11)", value: row.lsi_11 || 0 },
                { label: "Under the Bridge (LSI-12)", value: row.lsi_12 || 0 }
            ].map(segment => ({
                ...segment,
                count: segment.value,
                percentage: totalPopulation > 0 ? ((segment.value / totalPopulation) * 100).toFixed(1) : 0
            }));

            return {
                raw: row,
                incomeSegments,
                lifestyleSegments,
footfallData: {
    totalFootfall: row['footfall_index'] || 0,
    uniqueVisitorIndex: row['unique_visitor_index'] || 0,
    esi: [
        { label: "Low INR <20K", value: row['Low INR <20,000'] || 0 },
        { label: "Medium Low INR 20K-40K", value: row['Medium Low INR 20,000   40,000'] || 0 },
        { label: "Medium INR 40K-80K", value: row['Medium INR 40,000   80,000'] || 0 },
        { label: "Medium Good INR 80K-130K", value: row['Medium Good INR 80,000   1,30,000'] || 0 },
        { label: "Good INR 130K-170K", value: row['Good INR 1,30,000   1,70,000'] || 0 },
        { label: "Very Good INR 170K-230K", value: row['Very Good INR 1,70,000   2,30,000'] || 0 },
        { label: "High INR 230K-300K", value: row['High INR 2,30,000   3,00,000'] || 0 },
        { label: "Very High INR >300K", value: row['Very High INR > 3,00,000'] || 0 }
    ],
    lsi: [
        { label: "Urban Established Elite", value: row['LSI 01: Urban Established Elite'] || 0 },
        { label: "Urban New Wealth", value: row['LSI 02: Urban New Wealth'] || 0 },
        { label: "Aspiring Urban Middle Class", value: row['LSI 03: Aspiring Urban Middle Class'] || 0 },
        { label: "Conservative Urban Middle Class", value: row['LSI 04: Conservative Urban Middle Class'] || 0 },
        { label: "Successful Urban Fast Climbers", value: row['LSI 05: Successful Urban Fast Climbers'] || 0 },
        { label: "Upcoming Urban Climbers", value: row['LSI 06: Upcoming Urban Climbers'] || 0 },
        { label: "Striving Urban Climbers", value: row['LSI 07: Striving Urban Climbers'] || 0 },
        { label: "Urban Dependants", value: row['LSI 08: Urban Dependants'] || 0 },
        { label: "Daily Urban Survivors", value: row['LSI 09: Daily Urban Survivors'] || 0 }
    ]
}, 
                basicInfo: {
                    pincode: row.pincode,
                    location: row['Location '],
                    totalPopulation: totalPopulation,
                    catchmentHouseholds: totalHouseholds,
                    avgMonthlyIncome: row.avg_monthly_income || 0
                },
                spending: [
                    { label: "Housing", value: row.spend_housing || 0 },
                    { label: "Food & FMCG", value: row.spend_food_fmcg || 0 },
                    { label: "Apparel", value: row.spend_apparel || 0 },
                    { label: "Transportation", value: row.spend_transportation || 0 },
                    { label: "Healthcare & Medical", value: row.spend_healthcare_medical || 0 },
                    { label: "Financial Savings", value: row.spend_financial_savings || 0 },
                    { label: "Education", value: row.spend_education || 0 },
                    { label: "Entertainment", value: row.spend_entertainment || 0 },
                    { label: "Others", value: row.spend_others || 0 }
                ],
                education: (() => {
                    const educationSegments = [
                        { label: "Post Graduate", value: row.u_education_post_graduate || 0 },
                        { label: "Graduate", value: row.u_education_graduate || 0 },
                        { label: "Higher Secondary", value: row.u_education_higher_secondary || 0 },
                        { label: "Primary/Middle", value: row.u_education_primary_middle || 0 },
                        { label: "Illiterate", value: row.u_education_illiterate || 0 }
                    ];
                    return educationSegments.map(segment => ({
                        ...segment,
                        percentage: totalPopulation > 0 ? ((segment.value / totalPopulation) * 100).toFixed(2) : 0
                    }));
                })(),
                occupation: (() => {
                    const occupationSegments = [
                        { label: "Business", value: row.u_occ_business || 0 },
                        { label: "Salaried", value: row.u_occ_salaried || 0 },
                        { label: "Service", value: row.u_occ_service || 0 },
                        { label: "Workers", value: row.u_occ_workers || 0 },
                        { label: "Marginal Workers", value: row.u_occ_marginal_workers || 0 },
                        { label: "Non Workers", value: row.u_occ_non_workers || 0 },
                        { label: "Agricultural Workers", value: row.u_occ_agri_workers || 0 }
                    ];
                    return occupationSegments.map(segment => ({
                        ...segment,
                        percentage: totalPopulation > 0 ? ((segment.value / totalPopulation) * 100).toFixed(2) : 0
                    }));
                })(),
                banking: [
                    {
                        title: "Mutual Fund",
                        data: (() => {
                            const holding = row.mutual_fund || 0;
                            const notHolding = totalHouseholds - holding;
                            return [
                                { name: "Not Holding", value: notHolding > 0 ? notHolding : 0 },
                                { name: "Holding", value: holding }
                            ];
                        })()
                    },
                    {
                        title: "Fixed Deposit", 
                        data: (() => {
                            const holding = row.fixed_deposit || 0;
                            const notHolding = totalHouseholds - holding;
                            return [
                                { name: "Not Holding", value: notHolding > 0 ? notHolding : 0 },
                                { name: "Holding", value: holding }
                            ];
                        })()
                    },
                    {
                        title: "Saving Plan",
                        data: (() => {
                            const holding = row.saving_plan || 0;
                            const notHolding = totalHouseholds - holding;
                            return [
                                { name: "Not Holding", value: notHolding > 0 ? notHolding : 0 },
                                { name: "Holding", value: holding }
                            ];
                        })()
                    },
                    {
                        title: "Retirement Plan",
                        data: (() => {
                            const holding = row.retirement_plan || 0;
                            const notHolding = totalHouseholds - holding;
                            return [
                                { name: "Not Holding", value: notHolding > 0 ? notHolding : 0 },
                                { name: "Holding", value: holding }
                            ];
                        })()
                    },
                    {
                        title: "Unit Linked Plan",
                        data: (() => {
                            const holding = row.unit_linked_plan || 0;
                            const notHolding = totalHouseholds - holding;
                            return [
                                { name: "Not Holding", value: notHolding > 0 ? notHolding : 0 },
                                { name: "Holding", value: holding }
                            ];
                        })()
                    },
                    {
                        title: "Credit Card Usage",
                        data: (() => {
                            const rare = row.expected_rare_irregular_use || 0;
                            const moderate = row.expected_moderate_avg_use || 0;
                            const heavy = row.expected_heavy_frequent_use || 0;
                            const usageSum = rare + moderate + heavy;
                            const noAffinity = totalHouseholds - usageSum;
                            
                            const result = [
                                { name: "Rare/Irregular", value: rare },
                                { name: "Moderate/Average", value: moderate },
                                { name: "Heavy/Frequent", value: heavy }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    }
                ],
                fmcg: [
                    {
                        title: "Fabric Products",
                        data: (() => {
                            const mass = row.fmcg_mass_fabric_products || 0;
                            const premium = row.fmcg_premium_fabric_products || 0;
                            const fabricSum = mass + premium;
                            const noAffinity = totalHouseholds - fabricSum;
                            
                            const result = [
                                { name: "Mass Products", value: mass },
                                { name: "Premium Products", value: premium }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Washing Machine Products",
                        data: (() => {
                            const notUsing = row.fmcg_washing_machine_products ? totalHouseholds - row.fmcg_washing_machine_products : totalHouseholds;
                            const using = row.fmcg_washing_machine_products || 0;
                            return [
                                { name: "Not Using", value: notUsing > 0 ? notUsing : 0 },
                                { name: "Using", value: using }
                            ];
                        })()
                    },
                    {
                        title: "Personal Care",
                        data: (() => {
                            const mass = row.fmcg_personal_mass_classified || 0;
                            const popular = row.fmcg_personal_popular_classified || 0;
                            const premium = row.fmcg_personal_premium_classified || 0;
                            const personalSum = mass + popular + premium;
                            const noAffinity = totalHouseholds - personalSum;
                            
                            const result = [
                                { name: "Mass", value: mass },
                                { name: "Popular", value: popular },
                                { name: "Premium", value: premium }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Packaged Food",
                        data: (() => {
                            const mass = row.fmcg_packaged_food_mass_classified || 0;
                            const popular = row.fmcg_packaged_food_popular_classified || 0;
                            const premium = row.fmcg_packaged_food_premium_classified || 0;
                            const foodSum = mass + popular + premium;
                            const noAffinity = totalHouseholds - foodSum;
                            
                            const result = [
                                { name: "Mass", value: mass },
                                { name: "Popular", value: popular },
                                { name: "Premium", value: premium }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Food Health & Wellness",
                        data: (() => {
                            const healthWellness = row.fmcg_packaged_food_health_and_wellness || 0;
                            const noAffinity = totalHouseholds - healthWellness;
                            
                            return [
                                { name: "Health & Wellness Affinity", value: healthWellness },
                                { name: "No affinity", value: noAffinity > 0 ? noAffinity : 0 }
                            ];
                        })()
                    },
                    {
                        title: "Cosmetics",
                        data: (() => {
                            const mass = row.fmcg_cosmetics_mass_classified || 0;
                            const popular = row.fmcg_cosmetics_popular_classified || 0;
                            const premium = row.fmcg_cosmetics_premium_classified || 0;
                            const cosmeticsSum = mass + popular + premium;
                            const noAffinity = totalHouseholds - cosmeticsSum;
                            
                            const result = [
                                { name: "Mass", value: mass },
                                { name: "Popular", value: popular },
                                { name: "Premium", value: premium }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    }
                ],
                fashion: (() => {
                    const fashionSegments = [
                        { label: "Economy (<‚Çπ800)", value: row.fashion_apparel_economy || 0 },
                        { label: "Medium (‚Çπ800-2000)", value: row.fashion_apparel_medium || 0 },
                        { label: "Premium (‚Çπ2000-3500)", value: row.fashion_apparel_premium || 0 },
                        { label: "Super Premium (‚Çπ3500-7000)", value: row.fashion_apparel_super_premium || 0 },
                        { label: "Luxury (‚Çπ7000+)", value: row.fashion_apparel_luxury || 0 }
                    ];
                    return fashionSegments.map(segment => ({
                        ...segment,
                        percentage: totalHouseholds > 0 ? ((segment.value / totalHouseholds) * 100).toFixed(2) : '0.00'
                    }));
                })(),
                jewellery: [
                    {
                        title: "Jewellery Type",
                        data: (() => {
                            const branded = row.jewellery_gold_branded || 0;
                            const traditional = row.jewellery_gold_traditional_non_branded || 0;
                            const jewelSum = branded + traditional;
                            const noAffinity = totalHouseholds - jewelSum;
                            
                            const result = [
                                { name: "Branded", value: branded },
                                { name: "Traditional/Non-branded", value: traditional }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Gold Jewellery",
                        data: (() => {
                            const moderate = row.jewellery_gold_moderate_priced_gold || 0;
                            const high = row.jewellery_gold_high_priced_gold || 0;
                            const goldSum = moderate + high;
                            const noAffinity = totalHouseholds - goldSum;
                            
                            const result = [
                                { name: "Moderate Priced", value: moderate },
                                { name: "High Priced", value: high }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Diamond Jewellery",
                        data: (() => {
                            const moderate = row.jewellery_gold_moderate_priced_diamond || 0;
                            const high = row.jewellery_gold_high_priced_diamond || 0;
                            const diamondSum = moderate + high;
                            const noAffinity = totalHouseholds - diamondSum;
                            
                            const result = [
                                { name: "Moderate Priced", value: moderate },
                                { name: "High Priced", value: high }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    }
                ],
                realestate: (() => {
                    const realestateSegments = [
                        { label: "‚Çπ15-25L", value: row.real_estate_15l_25l || 0 },
                        { label: "‚Çπ25-50L", value: row.real_estate_25l_50l || 0 },
                        { label: "‚Çπ51L-1Cr", value: row.real_estate_51l_1cr || 0 },
                        { label: "‚Çπ1-4Cr", value: row.real_estate_1cr_4cr || 0 },
                        { label: ">‚Çπ4Cr", value: row.real_estate_4cr_beyond || 0 }
                    ];
                    return realestateSegments.map(segment => ({
                        ...segment,
                        percentage: totalHouseholds > 0 ? ((segment.value / totalHouseholds) * 100).toFixed(2) : 0
                    }));
                })(),
                retail: [
                    {
                        title: "Online Shopping Usage",
                        data: (() => {
                            const rare = row.online_rare_irregular_use || 0;
                            const moderate = row.online_moderate_avg_use || 0;
                            const heavy = row.online_heavy_frequent_use || 0;
                            const onlineSum = rare + moderate + heavy;
                            const noAffinity = totalHouseholds - onlineSum;
                            
                            const result = [
                                { name: "Rare/Irregular", value: rare },
                                { name: "Moderate/Average", value: moderate },
                                { name: "Heavy/Frequent", value: heavy }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Home & Living",
                        data: (() => {
                            const highPriced = row.retail_home_living_high_priced || 0;
                            const moderatePriced = row.retail_home_living_moderate_priced || 0;
                            const retailSum = highPriced + moderatePriced;
                            const noAffinity = totalHouseholds - retailSum;
                            
                            const result = [
                                { name: "High Priced", value: highPriced },
                                { name: "Moderate Priced", value: moderatePriced }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    }
                ],
                travel: [
                    {
                        title: "Short Term Travel",
                        data: (() => {
                            const basic = row.travel_short_term_basic || 0;
                            const luxury = row.travel_short_term_luxury || 0;
                            const shortSum = basic + luxury;
                            const noAffinity = totalHouseholds - shortSum;
                            
                            const result = [
                                { name: "Basic", value: basic },
                                { name: "Luxury", value: luxury }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Long Term Travel",
                        data: (() => {
                            const national = row.travel_long_term_national || 0;
                            const international = row.travel_long_term_international || 0;
                            const longSum = national + international;
                            const noAffinity = totalHouseholds - longSum;
                            
                            const result = [
                                { name: "National", value: national },
                                { name: "International", value: international }
                            ];
                            
                            if (noAffinity > 0) {
                                result.push({ name: "No affinity", value: noAffinity });
                            }
                            
                            return result;
                        })()
                    },
                    {
                        title: "Special Travel",
                        data: (() => {
                            const yes = row.travel_long_term_special || 0;
                            const noAffinity = totalHouseholds - yes;
                            
                            return [
                                { name: "Affinity", value: yes },
                                { name: "No affinity", value: noAffinity > 0 ? noAffinity : 0 }
                            ];
                        })()
                    }
                ],
                twowheeler: (() => {
                    const twowheelerSegments = [
                        { label: "Entry Level Scooter", value: row.two_wheeler_entry_level_scooter_segment || 0 },
                        { label: "Premium Scooter", value: row.two_wheeler_premium_scooter_segment || 0 },
                        { label: "Entry Level Commuter", value: row.two_wheeler_entry_level_commuter_segment || 0 },
                        { label: "Premium Commuter", value: row.two_wheeler_premium_commuter_segment || 0 },
                        { label: "Entry Level Sports Bike", value: row.two_wheeler_entry_level_sports_bike_segment || 0 },
                        { label: "Premium Sports Bike", value: row.two_wheeler_premium_sports_bike_segment || 0 },
                        { label: "Entry Level Cruiser", value: row.two_wheeler_entry_level_cruiser_bike_segment || 0 },
                        { label: "Premium Cruiser", value: row.two_wheeler_premium_cruiser_bike_segment || 0 },
                        { label: "Touring Bike", value: row.two_wheeler_touring_bike_segment || 0 },
                        { label: "Off-road Bike", value: row.two_wheeler_off_road_bike_segment || 0 }
                    ];
                    return twowheelerSegments.map(segment => ({
                        ...segment,
                        percentage: totalHouseholds > 0 ? ((segment.value / totalHouseholds) * 100).toFixed(2) : '0.00'
                    }));
                })(),
                automobile: (() => {
                    const automobileSegments = [                        
                        { label: "Entry Price Segment", value: row.automobile_entry_price_segment || 0 },
                        { label: "Entry Premium Hatch", value: row.automobile_entry_premium_hatch_segment || 0 },
                        { label: "Premium Hatch", value: row.automobile_premium_hatch_segment || 0 },
                        { label: "Compact Sedan", value: row.automobile_compact_sedan_segment || 0 },
                        { label: "Sedan", value: row.automobile_sedan_segment || 0 },
                        { label: "Premium Sedan", value: row.automobile_premium_sedan_segment || 0 },
                        { label: "Compact Entry SUV", value: row.automobile_compact_entry_suv_segment || 0 },
                        { label: "SUV", value: row.automobile_suv_segment || 0 },
                        { label: "Luxury Premium Sedan SUV", value: row.automobile_luxury_premium_sedan_suv_segment || 0 },
                        { label: "2nd Hand Sedan", value: row.automobile_2nd_hand_sedan_segment || 0 },
                        { label: "2nd Hand Premium Sedan SUV", value: row.automobile_2nd_hand_premium_sedan_suv || 0 },
                        { label: "2nd Hand Luxury Premium", value: row.automobile_2nd_hand_luxury_premium_sedan_suv || 0 }
                    ];
                    return automobileSegments.map(segment => ({
                        ...segment,
                        percentage: totalHouseholds > 0 ? ((segment.value / totalHouseholds) * 100).toFixed(2) : '0.00'
                    }));
                })()
            };
        }

        function updateOverviewTab() {
            if (!currentLocationData) return;
            
            const data = currentLocationData;
            const income = data.basicInfo.avgMonthlyIncome;
            const premiumIncome = data.incomeSegments.filter(s => s.label.includes('2,50,000') || s.label.includes('3,00,000') || s.label.includes('4,00,000')).reduce((sum, s) => sum + parseFloat(s.percentage), 0);
            const premiumLifestyle = data.lifestyleSegments.filter(s => s.label.includes('Elite') || s.label.includes('Affluent')).reduce((sum, s) => sum + parseFloat(s.percentage), 0);
            
            const metricsGrid = document.getElementById('metricsGrid');
            let footfallMetric = '';
            if (filterType === 'location' && data.footfallData && data.footfallData.totalFootfall > 0) {
                footfallMetric = `
                    <div class="metric-card">
                        <div class="metric-label">Total Footfall</div>
                        <div class="metric-value">${data.footfallData.totalFootfall.toLocaleString()}</div>
                        <div class="metric-desc">Footfall Index</div>
                    </div>
                `;
            }
            
            metricsGrid.innerHTML = `
                <div class="metric-card">
                    <div class="metric-label">Total Population</div>
                    <div class="metric-value">${data.basicInfo.totalPopulation.toLocaleString()}</div>
                    <div class="metric-desc">Total Catchment Population</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Total Households</div>
                    <div class="metric-value">${data.basicInfo.catchmentHouseholds.toLocaleString()}</div>
                    <div class="metric-desc">Total Catchment Households</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Avg Monthly Income</div>
                    <div class="metric-value">‚Çπ${(income/1000).toFixed(0)}K</div>
                    <div class="metric-desc">Average household income</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Premium Income Segment</div>
                    <div class="metric-value">${premiumIncome.toFixed(1)}%</div>
                    <div class="metric-desc">High monthly household level income (‚Çπ2L+)</div>
                </div>
                ${footfallMetric}
            `;
            
            // Generate analytics insights for the selected location
            generateAnalyticsInsights(data);
            document.getElementById('insightsSection').style.display = 'block';
        }

        function generateAnalyticsInsights(data) {
            const insightsGrid = document.getElementById('insightsGrid');
            
            // Get factual data from ALL tabs for summary
            let insights = '';
            
            // 1. Basic Analytics Tab Summary
            const income = data.basicInfo.avgMonthlyIncome;
            const population = data.basicInfo.totalPopulation;
            const households = data.basicInfo.catchmentHouseholds;
            
            insights += `
                <div class="insight-card">
                    <div class="insight-title">üìä Analytics Tab Summary</div>
                    <div class="insight-text">
                        <p><strong>Total Population:</strong> ${population.toLocaleString()}</p>
                        <p><strong>Total Households:</strong> ${households.toLocaleString()}</p>
                        <p><strong>Average Monthly Income:</strong> ‚Çπ${(income/1000).toFixed(0)}K</p>
                        <p><strong>Average Annual Income:</strong> ‚Çπ${(income*12/100000).toFixed(1)}L</p>
                    </div>
                </div>
            `;
            
            // 2. Income Segment Tab Summary
            const topIncomeSegment = data.incomeSegments.reduce((max, segment) => 
                parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
            );
            const secondIncomeSegment = [...data.incomeSegments].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
            
            insights += `
                <div class="insight-card">
                    <div class="insight-title">üí∞ Income Segment Tab Summary</div>
                    <div class="insight-text">
                        <p><strong>Top Income Segment:</strong> ${topIncomeSegment.label} (${topIncomeSegment.percentage}%)</p>
                        <p><strong>Second Income Segment:</strong> ${secondIncomeSegment.label} (${secondIncomeSegment.percentage}%)</p>
                        <p><strong>High Income (‚Çπ2L+) Households:</strong> ${data.incomeSegments.filter(s => s.label.includes('2,50,000') || s.label.includes('3,00,000') || s.label.includes('4,00,000')).reduce((sum, s) => sum + parseFloat(s.percentage), 0).toFixed(1)}%</p>
                    </div>
                </div>
            `;
            
            // 3. Lifestyle Segment Tab Summary  
            const topLifestyleSegment = data.lifestyleSegments.reduce((max, segment) => 
                parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
            );
            const secondLifestyleSegment = [...data.lifestyleSegments].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
            
            insights += `
                <div class="insight-card">
                    <div class="insight-title">üè° Lifestyle Segment Tab Summary</div>
                    <div class="insight-text">
                        <p><strong>Top Lifestyle Segment:</strong> ${topLifestyleSegment.label} (${topLifestyleSegment.percentage}%)</p>
                        <p><strong>Second Lifestyle Segment:</strong> ${secondLifestyleSegment.label} (${secondLifestyleSegment.percentage}%)</p>
                        <p><strong>Premium Lifestyle (Elite/Affluent):</strong> ${data.lifestyleSegments.filter(s => s.label.includes('Elite') || s.label.includes('Affluent')).reduce((sum, s) => sum + parseFloat(s.percentage), 0).toFixed(1)}%</p>
                    </div>
                </div>
            `;
            
            // 4. Spending Category Tab Summary
            if (data.spending && data.spending.length > 0) {
                const topSpending = data.spending.reduce((max, category) => 
                    parseFloat(category.value) > parseFloat(max.value) ? category : max
                );
                const secondSpending = [...data.spending].sort((a, b) => parseFloat(b.value) - parseFloat(a.value))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üí≥ Spending Patterns Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Spending Category:</strong> ${topSpending.label} (‚Çπ${topSpending.value.toLocaleString()})</p>
                            <p><strong>Second Spending Category:</strong> ${secondSpending.label} (‚Çπ${secondSpending.value.toLocaleString()})</p>
                            <p><strong>Total Categories Tracked:</strong> ${data.spending.length}</p>
                        </div>
                    </div>
                `;
            }
            
            // 5. Education Tab Summary
            if (data.education && data.education.length > 0) {
                const topEducation = data.education.reduce((max, segment) => 
                    parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
                );
                const secondEducation = [...data.education].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üéì Education Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Education Level:</strong> ${topEducation.label} (${topEducation.percentage}%)</p>
                            <p><strong>Second Education Level:</strong> ${secondEducation.label} (${secondEducation.percentage}%)</p>
                            <p><strong>Higher Education (Graduate+):</strong> ${data.education.filter(s => s.label.includes('Graduate')).reduce((sum, s) => sum + parseFloat(s.percentage), 0).toFixed(1)}%</p>
                        </div>
                    </div>
                `;
            }
            
            // 6. Occupation Tab Summary
            if (data.occupation && data.occupation.length > 0) {
                const topOccupation = data.occupation.reduce((max, segment) => 
                    parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
                );
                const secondOccupation = [...data.occupation].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üíº Occupation Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Occupation:</strong> ${topOccupation.label} (${topOccupation.percentage}%)</p>
                            <p><strong>Second Occupation:</strong> ${secondOccupation.label} (${secondOccupation.percentage}%)</p>
                            <p><strong>Professional (Business+Salaried):</strong> ${data.occupation.filter(s => s.label.includes('Business') || s.label.includes('Salaried')).reduce((sum, s) => sum + parseFloat(s.percentage), 0).toFixed(1)}%</p>
                        </div>
                    </div>
                `;
            }
            
            // 7. Fashion Tab Summary
            if (data.fashion && data.fashion.length > 0) {
                const topFashion = data.fashion.reduce((max, segment) => 
                    parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
                );
                const secondFashion = [...data.fashion].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üëó Fashion Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Fashion Segment:</strong> ${topFashion.label} (${topFashion.percentage}%)</p>
                            <p><strong>Second Fashion Segment:</strong> ${secondFashion.label} (${secondFashion.percentage}%)</p>
                            <p><strong>Premium Fashion (‚Çπ2000+):</strong> ${data.fashion.filter(s => s.label.includes('Premium') || s.label.includes('Super Premium') || s.label.includes('Luxury')).reduce((sum, s) => sum + parseFloat(s.percentage), 0).toFixed(1)}%</p>
                        </div>
                    </div>
                `;
            }
            
            // 8. Real Estate Tab Summary
            if (data.realestate && data.realestate.length > 0) {
                const topRealEstate = data.realestate.reduce((max, segment) => 
                    parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
                );
                const secondRealEstate = [...data.realestate].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üè¢ Real Estate Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Real Estate Segment:</strong> ${topRealEstate.label} (${topRealEstate.percentage}%)</p>
                            <p><strong>Second Real Estate Segment:</strong> ${secondRealEstate.label} (${secondRealEstate.percentage}%)</p>
                            <p><strong>Premium Real Estate (‚Çπ1Cr+):</strong> ${data.realestate.filter(s => s.label.includes('1-4Cr') || s.label.includes('>‚Çπ4Cr')).reduce((sum, s) => sum + parseFloat(s.percentage), 0).toFixed(1)}%</p>
                        </div>
                    </div>
                `;
            }
            
            // 9. Two Wheeler Tab Summary
            if (data.twowheeler && data.twowheeler.length > 0) {
                const topTwoWheeler = data.twowheeler.reduce((max, segment) => 
                    parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
                );
                const secondTwoWheeler = [...data.twowheeler].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üèçÔ∏è Two Wheeler Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Two Wheeler Segment:</strong> ${topTwoWheeler.label} (${topTwoWheeler.percentage}%)</p>
                            <p><strong>Second Two Wheeler Segment:</strong> ${secondTwoWheeler.label} (${secondTwoWheeler.percentage}%)</p>
                            <p><strong>Total Categories:</strong> ${data.twowheeler.length}</p>
                        </div>
                    </div>
                `;
            }
            
            // 10. Automobile Tab Summary
            if (data.automobile && data.automobile.length > 0) {
                const topAutomobile = data.automobile.reduce((max, segment) => 
                    parseFloat(segment.percentage) > parseFloat(max.percentage) ? segment : max
                );
                const secondAutomobile = [...data.automobile].sort((a, b) => parseFloat(b.percentage) - parseFloat(a.percentage))[1];
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üöó Automobile Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Top Automobile Segment:</strong> ${topAutomobile.label} (${topAutomobile.percentage}%)</p>
                            <p><strong>Second Automobile Segment:</strong> ${secondAutomobile.label} (${secondAutomobile.percentage}%)</p>
                            <p><strong>Total Categories:</strong> ${data.automobile.length}</p>
                        </div>
                    </div>
                `;
            }
            
            // 11. Banking Tab Summary
            if (data.banking && data.banking.length > 0) {
                let bankingSummary = '';
                data.banking.forEach(product => {
                    const holdingData = product.data.find(item => item.name === 'Holding');
                    if (holdingData) {
                        bankingSummary += `${product.title}: ${holdingData.value.toLocaleString()} households, `;
                    }
                });
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üè¶ Banking Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Banking Products Available:</strong> ${data.banking.length}</p>
                            <p><strong>Product Holdings:</strong></p>
                            <p>${bankingSummary.slice(0, -2)}</p>
                        </div>
                    </div>
                `;
            }
            
            // 12. FMCG Tab Summary
            if (data.fmcg && data.fmcg.length > 0) {
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üß¥ FMCG Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>FMCG Categories Available:</strong> ${data.fmcg.length}</p>
                            <p><strong>Categories:</strong> ${data.fmcg.map(item => item.title).join(', ')}</p>
                            <p><strong>Data Coverage:</strong> Personal care, fabric products, packaged food, cosmetics, and health & wellness</p>
                        </div>
                    </div>
                `;
            }
            
            // 13. Jewellery Tab Summary
            if (data.jewellery && data.jewellery.length > 0) {
                let jewelleryInsight = '';
                data.jewellery.forEach(product => {
                    if (product.title === 'Jewellery Type') {
                        const branded = product.data.find(item => item.name === 'Branded');
                        const traditional = product.data.find(item => item.name === 'Traditional/Non-branded');
                        if (branded && traditional) {
                            jewelleryInsight = `Branded: ${branded.value.toLocaleString()}, Traditional: ${traditional.value.toLocaleString()}`;
                        }
                    }
                });
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üíç Jewellery Tab Summary</div>
                        <div class="insight-text">
                            <p><strong>Jewellery Categories:</strong> ${data.jewellery.length}</p>
                            <p><strong>Jewellery Preference:</strong> ${jewelleryInsight}</p>
                            <p><strong>Types Available:</strong> Gold jewellery, diamond jewellery, branded vs traditional</p>
                        </div>
                    </div>
                `;
            }
            
            // 14. Retail Tab Summary - DETAILED CATEGORY-WISE
            if (data.retail && data.retail.length > 0) {
                let retailDetails = '';
                
                // Online Shopping Usage breakdown
                const onlineShoppingCategory = data.retail.find(item => item.title === 'Online Shopping Usage');
                if (onlineShoppingCategory) {
                    const rare = onlineShoppingCategory.data.find(d => d.name === 'Rare/Irregular');
                    const moderate = onlineShoppingCategory.data.find(d => d.name === 'Moderate/Average');
                    const heavy = onlineShoppingCategory.data.find(d => d.name === 'Heavy/Frequent');
                    retailDetails += `<p><strong>Online Shopping Usage:</strong></p>`;
                    if (rare) retailDetails += `<p>‚Ä¢ Rare/Irregular Users: ${rare.value.toLocaleString()} households</p>`;
                    if (moderate) retailDetails += `<p>‚Ä¢ Moderate/Average Users: ${moderate.value.toLocaleString()} households</p>`;
                    if (heavy) retailDetails += `<p>‚Ä¢ Heavy/Frequent Users: ${heavy.value.toLocaleString()} households</p>`;
                }
                
                // Home & Living breakdown
                const homeLivingCategory = data.retail.find(item => item.title === 'Home & Living');
                if (homeLivingCategory) {
                    const highPriced = homeLivingCategory.data.find(d => d.name === 'High Priced');
                    const moderatePriced = homeLivingCategory.data.find(d => d.name === 'Moderate Priced');
                    retailDetails += `<p><strong>Home & Living Products:</strong></p>`;
                    if (highPriced) retailDetails += `<p>‚Ä¢ High Priced Preference: ${highPriced.value.toLocaleString()} households</p>`;
                    if (moderatePriced) retailDetails += `<p>‚Ä¢ Moderate Priced Preference: ${moderatePriced.value.toLocaleString()} households</p>`;
                }
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">üõçÔ∏è Retail Tab Summary - Category-wise</div>
                        <div class="insight-text">
                            <p><strong>Retail Categories:</strong> ${data.retail.length}</p>
                            ${retailDetails}
                        </div>
                    </div>
                `;
            }
            
            // 15. Travel Tab Summary - DETAILED CATEGORY-WISE
            if (data.travel && data.travel.length > 0) {
                let travelDetails = '';
                
                // Short Term Travel breakdown
                const shortTermCategory = data.travel.find(item => item.title === 'Short Term Travel');
                if (shortTermCategory) {
                    const basic = shortTermCategory.data.find(d => d.name === 'Basic');
                    const luxury = shortTermCategory.data.find(d => d.name === 'Luxury');
                    travelDetails += `<p><strong>Short Term Travel:</strong></p>`;
                    if (basic) travelDetails += `<p>‚Ä¢ Basic Travel Preference: ${basic.value.toLocaleString()} households</p>`;
                    if (luxury) travelDetails += `<p>‚Ä¢ Luxury Travel Preference: ${luxury.value.toLocaleString()} households</p>`;
                }
                
                // Long Term Travel breakdown
                const longTermCategory = data.travel.find(item => item.title === 'Long Term Travel');
                if (longTermCategory) {
                    const national = longTermCategory.data.find(d => d.name === 'National');
                    const international = longTermCategory.data.find(d => d.name === 'International');
                    travelDetails += `<p><strong>Long Term Travel:</strong></p>`;
                    if (national) travelDetails += `<p>‚Ä¢ National Travel Preference: ${national.value.toLocaleString()} households</p>`;
                    if (international) travelDetails += `<p>‚Ä¢ International Travel Preference: ${international.value.toLocaleString()} households</p>`;
                }
                
                // Special Travel breakdown
                const specialTravelCategory = data.travel.find(item => item.title === 'Special Travel');
                if (specialTravelCategory) {
                    const affinity = specialTravelCategory.data.find(d => d.name === 'Affinity');
                    travelDetails += `<p><strong>Special Travel:</strong></p>`;
                    if (affinity) travelDetails += `<p>‚Ä¢ Special Travel Affinity: ${affinity.value.toLocaleString()} households</p>`;
                }
                
                insights += `
                    <div class="insight-card">
                        <div class="insight-title">‚úàÔ∏è Travel Tab Summary - Category-wise</div>
                        <div class="insight-text">
                            <p><strong>Travel Categories:</strong> ${data.travel.length}</p>
                            ${travelDetails}
                        </div>
                    </div>
                `;
            }          
            
            
            insightsGrid.innerHTML = insights;
        }
        
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').style.display = 'block';
            
            if (!currentLocationData) return;
            
            if (tabName === 'footfall' && !window.chartFlags?.footfall) {
                initFootfallAnalysis();
                window.chartFlags = { ...window.chartFlags, footfall: true };
            }
            if (tabName === 'poi' && !window.chartFlags?.poi) {
                initPOIAnalysis();
                window.chartFlags = { ...window.chartFlags, poi: true };
            }
            if (tabName === 'income' && !window.chartFlags?.income) {
                initIncomeChart();
                window.chartFlags = { ...window.chartFlags, income: true };
            }
            if (tabName === 'lifestyle' && !window.chartFlags?.lifestyle) {
                initLifestyleChart();
                window.chartFlags = { ...window.chartFlags, lifestyle: true };
            }
            if (tabName === 'spending' && !window.chartFlags?.spending) {
                initBarChart('spending', currentLocationData.spending, 'spendingChart', 'spendingBreakdown');
                window.chartFlags = { ...window.chartFlags, spending: true };
            }
            if (tabName === 'education' && !window.chartFlags?.education) {
                initBarChart('education', currentLocationData.education, 'educationChart', 'educationBreakdown');
                window.chartFlags = { ...window.chartFlags, education: true };
            }
            if (tabName === 'occupation' && !window.chartFlags?.occupation) {
                initBarChart('occupation', currentLocationData.occupation, 'occupationChart', 'occupationBreakdown');
                window.chartFlags = { ...window.chartFlags, occupation: true };
            }
            if (tabName === 'banking' && !window.chartFlags?.banking) {
                initProducts('banking', currentLocationData.banking);
                window.chartFlags = { ...window.chartFlags, banking: true };
            }
            if (tabName === 'fmcg' && !window.chartFlags?.fmcg) {
                initProducts('fmcg', currentLocationData.fmcg);
                window.chartFlags = { ...window.chartFlags, fmcg: true };
            }
            if (tabName === 'fashion' && !window.chartFlags?.fashion) {
                initBarChart('fashion', currentLocationData.fashion, 'fashionChart', 'fashionBreakdown');
                window.chartFlags = { ...window.chartFlags, fashion: true };
            }
            if (tabName === 'jewellery' && !window.chartFlags?.jewellery) {
                initProducts('jewellery', currentLocationData.jewellery);
                window.chartFlags = { ...window.chartFlags, jewellery: true };
            }
            if (tabName === 'realestate' && !window.chartFlags?.realestate) {
                initBarChart('realestate', currentLocationData.realestate, 'realestateChart', 'realestateBreakdown');
                window.chartFlags = { ...window.chartFlags, realestate: true };
            }
            if (tabName === 'retail' && !window.chartFlags?.retail) {
                initProducts('retail', currentLocationData.retail);
                window.chartFlags = { ...window.chartFlags, retail: true };
            }
            if (tabName === 'travel' && !window.chartFlags?.travel) {
                initProducts('travel', currentLocationData.travel);
                window.chartFlags = { ...window.chartFlags, travel: true };
            }
            if (tabName === 'twowheeler' && !window.chartFlags?.twowheeler) {
                initBarChart('twowheeler', currentLocationData.twowheeler, 'twowheelerChart', 'twowheelerBreakdown');
                window.chartFlags = { ...window.chartFlags, twowheeler: true };
            }
            if (tabName === 'automobile' && !window.chartFlags?.automobile) {
                initBarChart('automobile', currentLocationData.automobile, 'automobileChart', 'automobileBreakdown');
                window.chartFlags = { ...window.chartFlags, automobile: true };
            }
            if (tabName === 'locations' && !window.chartFlags?.locations) {
                initLocationsMap();
                window.chartFlags = { ...window.chartFlags, locations: true };
            }
        }

        function initFootfallAnalysis() {
            if (!currentLocationData || filterType !== 'location') return;
            
            const footfallData = currentLocationData.footfallData;
            
            // Update footfall metrics
            const metricsContainer = document.getElementById('footfallMetrics');
            const totalESI = footfallData.esi.reduce((sum, item) => sum + item.value, 0);
            const totalLSI = footfallData.lsi.reduce((sum, item) => sum + item.value, 0);
            const topESI = footfallData.esi.reduce((max, item) => item.value > max.value ? item : max, footfallData.esi[0]);
            const topLSI = footfallData.lsi.reduce((max, item) => item.value > max.value ? item : max, footfallData.lsi[0]);
            
            metricsContainer.innerHTML = `
                <div class="metric-card">
                    <div class="metric-label">Unique Visitor Index </div>
                    <div class="metric-value">${footfallData.uniqueVisitorIndex.toLocaleString()}</div>
                    <div class="metric-desc">Mobile Device Footfall (MAID)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label"> Footfall Index </div>
                    <div class="metric-value">${footfallData.totalFootfall.toLocaleString()}</div>
                    <div class="metric-desc">Footfall Index</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Top ESI Segment</div>
                    <div class="metric-value">${topESI.label}</div>
                    <div class="metric-desc">${topESI.value.toLocaleString()} Visitors Index</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Top LSI Segment</div>
                    <div class="metric-value">${topLSI.label}</div>
                    <div class="metric-desc">${topLSI.value.toLocaleString()} Visitors Index</div>
                </div>
            `;
            
            // ESI Chart
            const esiColors = generateColors(footfallData.esi.length);
            const esiCtx = document.getElementById('esiChart').getContext('2d');
            charts.esi = new Chart(esiCtx, {
                type: 'bar',
                data: {
                    labels: footfallData.esi.map(s => s.label),
                    datasets: [{
                        label: 'Footfall Count (Index)',
                        data: footfallData.esi.map(s => s.value),
                        backgroundColor: esiColors,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Footfall Count', color: '#2a5b7f' },
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        }
                    }
                }
            });
            
            // LSI Chart
            const lsiColors = generateColors(footfallData.lsi.length);
            const lsiCtx = document.getElementById('lsiChart').getContext('2d');
            charts.lsi = new Chart(lsiCtx, {
                type: 'bar',
                data: {
                    labels: footfallData.lsi.map(s => s.label),
                    datasets: [{
                        label: 'Footfall Count (Index)',
                        data: footfallData.lsi.map(s => s.value),
                        backgroundColor: lsiColors,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Footfall Count', color: '#2a5b7f' },
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        }
                    }
                }
            });
            
            // Breakdown
            const breakdown = document.getElementById('footfallBreakdown');
            breakdown.innerHTML = '';
            
            // ESI breakdown
            const esiTitle = document.createElement('h5');
            esiTitle.textContent = 'Footfall(index) By Monthly Income Breakdown';
            esiTitle.style.cssText = 'font-weight: 600; color: #2a5b7f; margin-bottom: 1rem; font-size: 1rem;';
            breakdown.appendChild(esiTitle);
            
            footfallData.esi.forEach(segment => {
                const percentage = totalESI > 0 ? ((segment.value / totalESI) * 100).toFixed(1) : 0;
                const item = document.createElement('div');
                item.className = 'breakdown-item';
                item.innerHTML = `
                    <div class="breakdown-label">${segment.label}</div>
                    <div class="breakdown-value">${segment.value.toLocaleString()} </div>
                `;
                breakdown.appendChild(item);
            });
            
            // LSI breakdown
            const lsiTitle = document.createElement('h5');
            lsiTitle.textContent = 'Footfall(index) By Lifestyle Affinity Breakdown';
            lsiTitle.style.cssText = 'font-weight: 600; color: #2a5b7f; margin: 2rem 0 1rem 0; font-size: 1rem;';
            breakdown.appendChild(lsiTitle);
            
            footfallData.lsi.forEach(segment => {
                const percentage = totalLSI > 0 ? ((segment.value / totalLSI) * 100).toFixed(1) : 0;
                const item = document.createElement('div');
                item.className = 'breakdown-item';
                item.innerHTML = `
                    <div class="breakdown-label">${segment.label}</div>
                    <div class="breakdown-value">${segment.value.toLocaleString()} </div>
                `;
                breakdown.appendChild(item);
            });
        }

        function initPOIAnalysis() {
            console.log('initPOIAnalysis called');
            
            if (!currentLocationData) {
                console.log('No currentLocationData available');
                return;
            }
            
            let locationPOIs = [];
            let searchCriteria = '';
            
            if (filterType === 'location') {
                // Location-based filtering
                const currentLocation = currentLocationData.basicInfo.location;
                console.log('Current location for POI analysis:', currentLocation);
                searchCriteria = `location: ${currentLocation}`;
                
                // Try different location field variations and matching approaches
                locationPOIs = poiData.filter(poi => poi.location === currentLocation);
                
                if (locationPOIs.length === 0) {
                    locationPOIs = poiData.filter(poi => poi['Location '] === currentLocation);
                }
                
                if (locationPOIs.length === 0) {
                    const currentLocationLower = currentLocation.toLowerCase();
                    locationPOIs = poiData.filter(poi => {
                        const poiLocation = (poi.location || poi['Location '] || '').toLowerCase();
                        return poiLocation === currentLocationLower;
                    });
                }
                
                if (locationPOIs.length === 0) {
                    const currentLocationLower = currentLocation.toLowerCase();
                    locationPOIs = poiData.filter(poi => {
                        const poiLocation = (poi.location || poi['Location '] || '').toLowerCase();
                        return poiLocation.includes(currentLocationLower) || currentLocationLower.includes(poiLocation);
                    });
                }
                
            } else {
                // Pincode-based filtering
                const currentPincode = currentLocationData.basicInfo.pincode;
                console.log('Current pincode for POI analysis:', currentPincode);
                searchCriteria = `pincode: ${currentPincode}`;
                
                // Filter POI data by pincode
                locationPOIs = poiData.filter(poi => {
                    return poi.pincode == currentPincode || 
                           poi.Pincode == currentPincode || 
                           poi['Pincode '] == currentPincode ||
                           poi.PINCODE == currentPincode;
                });
                
                // If no exact match, try as string comparison
                if (locationPOIs.length === 0) {
                    const pincodeStr = String(currentPincode);
                    locationPOIs = poiData.filter(poi => {
                        const poiPincode = String(poi.pincode || poi.Pincode || poi['Pincode '] || poi.PINCODE || '');
                        return poiPincode === pincodeStr;
                    });
                }
            }
            
            console.log('Available POI data sample:', poiData.slice(0, 3));
            console.log(`Found ${locationPOIs.length} POIs for ${searchCriteria}`);
            
            if (locationPOIs.length === 0) {
                // Show available locations/pincodes for debugging
                let availableOptions = [];
                if (filterType === 'location') {
                    availableOptions = [...new Set(poiData.map(poi => poi.location || poi['Location '] || 'Unknown'))];
                } else {
                    availableOptions = [...new Set(poiData.map(poi => poi.pincode || poi.Pincode || poi['Pincode '] || poi.PINCODE || 'Unknown'))];
                }
                console.log(`Available POI ${filterType}s:`, availableOptions.slice(0, 10));
                
                document.getElementById('poiMetrics').innerHTML = `
                    <div class="no-data">
                        <p>No POI data available for ${searchCriteria}</p>
                        <p>Total POI records: ${poiData.length}</p>
                        <p>Available ${filterType}s: ${availableOptions.length}</p>
                        <p>Sample available ${filterType}s: ${availableOptions.slice(0, 5).join(', ')}</p>
                    </div>
                `;
                document.getElementById('poiCategoriesGrid').innerHTML = '';
                document.getElementById('poiBreakdown').innerHTML = '';
                return;
            }
            
            // Process POI data by categories
            const poiByCategory = {};
            const categoryMappings = {
                'atm': { name: 'ATMs', icon: 'üèß', description: 'Automated Teller Machines' },
                'bank': { name: 'Banks', icon: 'üè¶', description: 'Banking Services' },
                'cinema_halls_and_theatres': { name: 'Cinemas', icon: 'üé¨', description: 'Entertainment Venues' },
                'educational_institutions': { name: 'Education', icon: 'üéì', description: 'Schools & Colleges' },
                'entertainment_locations': { name: 'Entertainment', icon: 'üéÆ', description: 'Recreation Centers' },
                'fashion_and_apparel': { name: 'Fashion', icon: 'üëï', description: 'Clothing & Accessories' },
                'furniture_stores': { name: 'Furniture', icon: 'üõãÔ∏è', description: 'Home Furnishing' },
                'gym_and_fitness_centres': { name: 'Fitness', icon: 'üí™', description: 'Health & Wellness' },
                'hospitals': { name: 'Healthcare', icon: 'üè•', description: 'Medical Services' },
                'hotels': { name: 'Hotels', icon: 'üè®', description: 'Accommodation' },
                'jewellery_store': { name: 'Jewellery', icon: 'üíé', description: 'Jewelry & Gems' },
                'luxury_brands': { name: 'Luxury', icon: 'üëë', description: 'Premium Brands' },
                'office_locations': { name: 'Offices', icon: 'üè¢', description: 'Business Centers' },
                'petrol_stations': { name: 'Fuel', icon: '‚õΩ', description: 'Petrol Stations' },
                'pharmacy': { name: 'Pharmacy', icon: 'üíä', description: 'Medical Stores' },
                'qsr': { name: 'QSR', icon: 'üçî', description: 'Quick Service Restaurants' },
                'religious_places': { name: 'Religious', icon: 'üïå', description: 'Places of Worship' },
                'restaurants_and_cafe': { name: 'Restaurants', icon: 'üçΩÔ∏è', description: 'Dining & Cafes' },
                'shopping_centres_and_malls': { name: 'Shopping', icon: 'üõçÔ∏è', description: 'Malls & Centers' },
                'supermarkets': { name: 'Supermarkets', icon: 'üõí', description: 'Grocery Stores' },
                'tourist_locations': { name: 'Tourism', icon: 'üó∫Ô∏è', description: 'Tourist Attractions' },
                'transit_hubs': { name: 'Transit', icon: 'üöá', description: 'Transportation Hubs' }
            };
            
            locationPOIs.forEach(poi => {
                if (!poiByCategory[poi.category]) {
                    poiByCategory[poi.category] = {
                        count: 0,
                        subcategories: {},
                        items: []
                    };
                }
                poiByCategory[poi.category].count++;
                poiByCategory[poi.category].items.push(poi);
                
                if (!poiByCategory[poi.category].subcategories[poi.sub_category]) {
                    poiByCategory[poi.category].subcategories[poi.sub_category] = 0;
                }
                poiByCategory[poi.category].subcategories[poi.sub_category]++;
            });
            
            // Update POI metrics
            const totalPOIs = locationPOIs.length;
            const totalCategories = Object.keys(poiByCategory).length;
            const topCategory = Object.entries(poiByCategory).reduce((max, [category, data]) => 
                data.count > max.count ? { category, count: data.count } : max, { category: '', count: 0 });
            
            const metricsContainer = document.getElementById('poiMetrics');
            metricsContainer.innerHTML = `
                <div class="metric-card">
                    <div class="metric-label-total-poi">TOTAL POIs</div>
                    <div class="metric-value">${totalPOIs}</div>
                    <div class="metric-desc">Points of Interest</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Categories</div>
                    <div class="metric-value">${totalCategories}</div>
                    <div class="metric-desc">Different POI Types</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Top Category</div>
                    <div class="metric-value">${categoryMappings[topCategory.category]?.name || topCategory.category}</div>
                    <div class="metric-desc">${topCategory.count} locations</div>
                </div>
            `;
            
            // Update POI categories grid
            const categoriesGrid = document.getElementById('poiCategoriesGrid');
            categoriesGrid.innerHTML = '';
            
            Object.entries(poiByCategory).sort(([,a], [,b]) => b.count - a.count).forEach(([category, data]) => {
                const categoryInfo = categoryMappings[category] || { name: category, icon: 'üìç', description: 'Various Services' };
                const topSubcategory = Object.entries(data.subcategories).reduce((max, [sub, count]) => 
                    count > max.count ? { sub, count } : max, { sub: '', count: 0 });
                
                const card = document.createElement('div');
                card.className = 'insight-card';
                card.innerHTML = `
                    <div class="insight-title">${categoryInfo.icon} ${categoryInfo.name}</div>
                    <div class="insight-text">
                        <p><strong>${data.count}</strong> locations in this category</p>
                        <p><strong>Top subcategory:</strong> ${topSubcategory.sub} (${topSubcategory.count} locations)</p>
                        <p>${categoryInfo.description}</p>
                    </div>
                `;
                categoriesGrid.appendChild(card);
            });
            
            // Update POI breakdown
            const breakdown = document.getElementById('poiBreakdown');
            breakdown.innerHTML = '';
            
            Object.entries(poiByCategory).sort(([,a], [,b]) => b.count - a.count).forEach(([category, data]) => {
                const categoryInfo = categoryMappings[category] || { name: category, icon: 'üìç' };
                
                // Category header
                const categoryHeader = document.createElement('h5');
                categoryHeader.textContent = `${categoryInfo.icon} ${categoryInfo.name} (${data.count} locations)`;
                categoryHeader.style.cssText = 'font-weight: 600; color: #2a5b7f; margin: 2rem 0 1rem 0; font-size: 1.125rem; border-bottom: 2px solid #3ec1bd; padding-bottom: 0.5rem;';
                breakdown.appendChild(categoryHeader);
                
                // Subcategory breakdown
                Object.entries(data.subcategories).sort(([,a], [,b]) => b - a).forEach(([subcategory, count]) => {
                    const percentage = ((count / data.count) * 100).toFixed(1);
                    const item = document.createElement('div');
                    item.className = 'breakdown-item';
                    item.style.marginLeft = '1rem';
                    item.innerHTML = `
                        <div class="breakdown-label">${subcategory}</div>
                        <div class="breakdown-value">${count} locations (${percentage}%)</div>
                    `;
                    breakdown.appendChild(item);
                });
            });
        }

        function clearCharts() {
            Object.values(charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
            charts = {};
            
            // Clear footfall specific elements
            const footfallMetrics = document.getElementById('footfallMetrics');
            if (footfallMetrics) footfallMetrics.innerHTML = '';
            const footfallBreakdown = document.getElementById('footfallBreakdown');
            if (footfallBreakdown) footfallBreakdown.innerHTML = '';
            
            // Clear POI specific elements
            const poiMetrics = document.getElementById('poiMetrics');
            if (poiMetrics) poiMetrics.innerHTML = '';
            const poiCategoriesGrid = document.getElementById('poiCategoriesGrid');
            if (poiCategoriesGrid) poiCategoriesGrid.innerHTML = '';
            const poiBreakdown = document.getElementById('poiBreakdown');
            if (poiBreakdown) poiBreakdown.innerHTML = '';
            
            window.chartFlags = {};
        }

        function generateColors(count) {
            const colors = [];
            for (let i = 0; i < count; i++) {
                const ratio = i / Math.max(count - 1, 1);
                if (ratio < 0.33) {
                    colors.push(`rgba(42, 91, 127, ${0.6 + ratio * 0.4})`);
                } else if (ratio < 0.67) {
                    colors.push(`rgba(62, 193, 189, ${0.6 + (ratio - 0.33) * 0.4})`);
                } else {
                    colors.push(`rgba(0, 255, 255, ${0.6 + (ratio - 0.67) * 0.4})`);
                }
            }
            return colors;
        }

        function initIncomeChart() {
            if (!currentLocationData) return;
            
            // Create defensive copy to prevent mutations
            const data = currentLocationData.incomeSegments.map(item => ({...item}));
            const colors = generateColors(data.length);
            
            const ctx = document.getElementById('incomeChart').getContext('2d');
            charts.income = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(s => s.label),
                    datasets: [{
                        label: 'Households (%)',
                        data: data.map(s => parseFloat(s.percentage)),
                        backgroundColor: colors,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Percentage (%)', color: '#2a5b7f' },
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#2a5b7f', maxRotation: 45 },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        }
                    }
                }
            });
            
            const breakdown = document.getElementById('incomeBreakdown');
            breakdown.innerHTML = '';
            data.forEach(segment => {
                const item = document.createElement('div');
                item.className = 'breakdown-item';
                item.innerHTML = `
                    <div class="breakdown-label">${segment.label}</div>
                    <div class="breakdown-value">${segment.count.toLocaleString()} (${segment.percentage}%)</div>
                `;
                breakdown.appendChild(item);
            });
        }

        function initLifestyleChart() {
            if (!currentLocationData) return;
            
            // Create defensive copy to prevent mutations
            const data = currentLocationData.lifestyleSegments.map(item => ({...item}));
            const colors = generateColors(data.length);
            
            const ctx = document.getElementById('lifestyleChart').getContext('2d');
            charts.lifestyle = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(s => s.label),
                    datasets: [{
                        label: 'Population (%)',
                        data: data.map(s => parseFloat(s.percentage)),
                        backgroundColor: colors,
                        borderRadius: 10
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: { display: true, text: 'Percentage (%)', color: '#2a5b7f' },
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        },
                        y: {
                            ticks: { color: '#2a5b7f' },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        }
                    }
                }
            });
            
            const breakdown = document.getElementById('lifestyleBreakdown');
            breakdown.innerHTML = '';
            data.forEach(segment => {
                const item = document.createElement('div');
                item.className = 'breakdown-item';
                item.innerHTML = `
                    <div class="breakdown-label">${segment.label}</div>
                    <div class="breakdown-value">${segment.count.toLocaleString()} (${segment.percentage}%)</div>
                `;
                breakdown.appendChild(item);
            });
        }

        function initBarChart(category, data, chartId, breakdownId) {
            if (!currentLocationData) return;
            
            // Create a defensive copy to prevent any mutations
            const dataCopy = data.map(item => ({...item}));
            
            const total = dataCopy.reduce((sum, item) => sum + item.value, 0);
            
            const colors = generateColors(dataCopy.length);
            
            let yAxisLabel = 'Count';
            let chartData = dataCopy.map(s => s.value);
            
            // For spending categories, use rupees
            if (category === 'spending') {
                yAxisLabel = 'Amount (‚Çπ)';
            }
            
            // For categories that should show percentages (education, realestate)
            // But only if the data has percentage values calculated
            if ((category === 'education' || category === 'occupation' || category === 'realestate' || category === 'fashion'|| category === 'twowheeler' || category === 'automobile') && dataCopy.length > 0 && dataCopy[0].hasOwnProperty('percentage')) {
                yAxisLabel = 'Percentage (%)';
                chartData = dataCopy.map(s => {
                    const percentage = parseFloat(s.percentage);
                    return isNaN(percentage) ? 0 : percentage;
                });
            }
            
            const ctx = document.getElementById(chartId).getContext('2d');
            charts[category] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: dataCopy.map(s => s.label),
                    datasets: [{
                        label: yAxisLabel,
                        data: chartData,
                        backgroundColor: colors,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: yAxisLabel, color: '#2a5b7f' },
                            ticks: { 
                                color: '#2a5b7f',
                                callback: function(value) {
                                    if (yAxisLabel === 'Amount (‚Çπ)') {
                                        return '‚Çπ' + value.toLocaleString();
                                    }
                                    return value;
                                }
                            },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#2a5b7f', maxRotation: 45 },
                            grid: { color: 'rgba(62, 193, 189, 0.1)' }
                        }
                    }
                }
            });
            
            const breakdown = document.getElementById(breakdownId);
            breakdown.innerHTML = '';
            
            // Show ALL data entries, including those with 0 values - use the original data copy
            dataCopy.forEach(segment => {
                const item = document.createElement('div');
                item.className = 'breakdown-item';
                
                if ((category === 'occupation'|| category === 'fashion'||category === 'education' || category === 'realestate' || category === 'twowheeler' || category === 'automobile') && segment.hasOwnProperty('percentage')) {
                    // For education, realestate, twowheeler, and automobile - show both value and percentage
                    const displayPercentage = segment.percentage || '0.00';
                    item.innerHTML = `
                        <div class="breakdown-label">${segment.label}</div>
                        <div class="breakdown-value">${segment.value.toLocaleString()} (${displayPercentage}%)</div>
                    `;
                } else {
                    // For all other categories, show value and percentage of total
                    const pct = total > 0 ? ((segment.value / total) * 100).toFixed(1) : '0.0';
                    let valueDisplay = segment.value.toLocaleString();
                    if (category === 'spending') {
                        valueDisplay = '‚Çπ' + valueDisplay;
                    }
                    item.innerHTML = `
                        <div class="breakdown-label">${segment.label}</div>
                        <div class="breakdown-value">${valueDisplay}</div>
                    `;
                }
                breakdown.appendChild(item);
            });
        }

        function initProducts(category, products) {
            const container = document.getElementById(category + 'Products');
            container.innerHTML = '';
            
            products.forEach((product, idx) => {
                const total = product.data.reduce((sum, item) => sum + item.value, 0);
                if (total === 0) return;
                
                const colors = generateColors(product.data.length);
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
                    <h4 class="product-title">${product.title}</h4>
                    <canvas id="${category}Chart${idx}" height="200"></canvas>
                    <div class="product-legend" id="${category}Legend${idx}"></div>
                `;
                container.appendChild(card);
                
                setTimeout(() => {
                    const ctx = document.getElementById(`${category}Chart${idx}`).getContext('2d');
                    const chartKey = `${category}${idx}`;
                    charts[chartKey] = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: product.data.map(d => d.name),
                            datasets: [{
                                data: product.data.map(d => d.value),
                                backgroundColor: colors
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: { legend: { display: false } }
                        }
                    });
                    
                    const legend = document.getElementById(`${category}Legend${idx}`);
                    product.data.forEach((item, i) => {
                        const legendItem = document.createElement('div');
                        legendItem.className = 'legend-item';
                        legendItem.innerHTML = `
                            <div class="legend-label">
                                <div class="legend-color" style="background-color: ${colors[i]}"></div>
                                <span>${item.name}</span>
                            </div>
                            <span class="legend-value">${item.value.toLocaleString()} (${((item.value / total) * 100).toFixed(1)}%)</span>
                        `;
                        legend.appendChild(legendItem);
                    });
                }, 100);
            });
        }

        window.addEventListener('load', loadData);
        
        // Map-related functions
        function initLocationsMap() {
            if (mapInitialized) return;
            
            // Extract location data with coordinates
            const locationData = extractLocationDataFromCSV();
            
            if (locationData.length === 0) {
                document.getElementById('locationMap').innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #64748b; font-style: italic;">No location data with coordinates found</div>';
                return;
            }
            
            // Initialize the map
            const centerLat = locationData.reduce((sum, loc) => sum + loc.lat, 0) / locationData.length;
            const centerLng = locationData.reduce((sum, loc) => sum + loc.lng, 0) / locationData.length;
            
            map = L.map('locationMap', {
                attributionControl: false  // Disable attribution control
            }).setView([centerLat, centerLng], 11);
            
            // Add satellite layer as default
            L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: ''
            }).addTo(map);
            
            addMarkersToMap(locationData);
            populateLocationsList(locationData);
            
            // Initialize competitors layer
            initializeCompetitorsLayer();
            
            // Initialize GPKG layer
            initializeGpkgLayer();
            
            mapInitialized = true;
        }
        
        function extractLocationDataFromCSV() {
            const locations = [];
            
            // Try to extract unique locations with coordinates
            const locationMap = new Map();
            
            for (const row of csvData) {
                // Look for location identifier and coordinates
                const locationName = row['Location '] || row['Location'] || row['Name'] || row['ID'];
                const lat = row['Latitude'] || row['latitude'] || row['lat'];
                const lng = row['Longitude'] || row['longitude'] || row['lng'] || row['long'];
                
                if (locationName && lat && lng) {
                    const key = locationName.toString().trim();
                    if (!locationMap.has(key)) {
                        locationMap.set(key, {
                            id: row['ID'] || locations.length + 1,
                            name: locationName.toString().trim(),
                            lat: parseFloat(lat),
                            lng: parseFloat(lng)
                        });
                    }
                }
            }
            
            return Array.from(locationMap.values()).filter(loc => !isNaN(loc.lat) && !isNaN(loc.lng));
        }
        
        function addMarkersToMap(locationData) {
            // Clear existing markers
            mapMarkers.forEach(marker => map.removeLayer(marker));
            mapMarkers = [];
            
            locationData.forEach((location, index) => {
                const customIcon = L.divIcon({
                    className: 'custom-div-icon',
                    html: `<div style="background: #2a5b7f; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 3px solid white; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">${index + 1}</div>`,
                    iconSize: [30, 30],
                    iconAnchor: [15, 15]
                });
                
                // Clean up the location name for popup
                let cleanName = location.name
                    .replace(/Domino's Pizza\s*/gi, 'Store ')
                    .replace(/Store\s*Store\s*/gi, 'Store ')
                    .trim();
                
                const marker = L.marker([location.lat, location.lng], { icon: customIcon })
                    .bindPopup(`
                        <div class="custom-popup">
                            <div class="popup-title">${cleanName}</div>
                            <div class="popup-coords">üìç ${location.lat.toFixed(6)}, ${location.lng.toFixed(6)}</div>
                            <div style="margin-top: 10px; font-size: 0.85rem; color: #64748b;">Store ID: ${location.id}</div>
                        </div>
                    `);
                
                mapMarkers.push(marker);
                marker.addTo(map);
            });
        }
        
        function populateLocationsList(locationData) {
            const locationsList = document.getElementById('locationsList');
            const totalStores = document.getElementById('totalStores');
            
            totalStores.textContent = locationData.length;
            locationsList.innerHTML = '';
            
            locationData.forEach((location, index) => {
                const locationItem = document.createElement('div');
                locationItem.className = 'location-item';
                
                // Clean up the location name - remove brand names and extra text
                let cleanName = location.name
                    .replace(/Domino's Pizza\s*/gi, '')
                    .replace(/Store\s*/gi, '')
                    .replace(/\s*,\s*Bangalore\s*/gi, '')
                    .replace(/\s*-\s*/g, ' ')
                    .trim();
                
                locationItem.innerHTML = `
                    <div class="location-name">${index + 1}. ${cleanName}</div>
                    <div class="location-coords">${location.lat.toFixed(4)}, ${location.lng.toFixed(4)}</div>
                `;
                
                locationItem.addEventListener('click', () => {
                    map.setView([location.lat, location.lng], 15);
                    mapMarkers[index].openPopup();
                });
                
                locationsList.appendChild(locationItem);
            });
        }
        
        function switchMapLayer(layerType) {
            if (!map) return;
            
            // Update button states
            document.querySelectorAll('.map-control-btn').forEach(btn => btn.classList.remove('active'));
            
            if (layerType === 'satellite') {
                document.getElementById('satelliteBtn').classList.add('active');
                map.eachLayer(layer => {
                    if (layer instanceof L.TileLayer) {
                        map.removeLayer(layer);
                    }
                });
                L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                    attribution: ''
                }).addTo(map);
            } else if (layerType === 'street') {
                document.getElementById('streetBtn').classList.add('active');
                map.eachLayer(layer => {
                    if (layer instanceof L.TileLayer) {
                        map.removeLayer(layer);
                    }
                });
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: ''
                }).addTo(map);
            }
        }
        
        function initializeCompetitorsLayer() {
            if (!competitorsData || competitorsData.length === 0) {
                console.log('No competitors data available');
                return;
            }
            
            // Create competitors layer but don't add to map initially
            competitorsLayer = L.layerGroup();
            
            console.log(`Loading ${competitorsData.length} competitor locations`);
            
            competitorsData.forEach(competitor => {
                const lat = parseFloat(competitor.Latitude);
                const lng = parseFloat(competitor.Longitude);
                const name = competitor.Name || 'Unknown';
                
                if (lat && lng && name) {
                    const color = competitorColors[name] || '#999999';
                    
                    const marker = L.marker([lat, lng], {
                        icon: L.divIcon({
                            className: 'competitor-marker-icon',
                            html: `<div style="
                                background: ${color}; 
                                width: 18px; 
                                height: 18px; 
                                border-radius: 50%; 
                                border: 2px solid white; 
                                box-shadow: 0 2px 6px rgba(0,0,0,0.4);
                            "></div>`,
                            iconSize: [22, 22],
                            iconAnchor: [11, 11]
                        })
                    });
                    
                    marker.bindPopup(`
                        <div style="font-size: 12px;">
                            <strong>üè¢ ${name}</strong><br>
                            <strong>Type:</strong> Competitor<br>
                            <strong>Location:</strong> ${lat.toFixed(4)}, ${lng.toFixed(4)}
                        </div>
                    `);
                    
                    marker.addTo(competitorsLayer);
                }
            });
            
            // Create legend
            createCompetitorsLegend();
        }
        
        function createCompetitorsLegend() {
            if (!competitorsData || competitorsData.length === 0) return;
            
            // Get unique competitor names and their counts
            const competitorCounts = {};
            competitorsData.forEach(competitor => {
                const name = competitor.Name || 'Unknown';
                competitorCounts[name] = (competitorCounts[name] || 0) + 1;
            });
            
            // Create legend items
            const legendItems = document.getElementById('competitorLegendItems');
            let legendHtml = '';
            
            Object.keys(competitorCounts).sort().forEach(competitor => {
                const color = competitorColors[competitor] || '#999999';
                const count = competitorCounts[competitor];
                
                legendHtml += `
                    <div class="competitor-legend-item">
                        <div class="competitor-marker" style="background-color: ${color};"></div>
                        <span>${competitor} (${count})</span>
                    </div>
                `;
            });
            
            legendItems.innerHTML = legendHtml;
        }
        
        function toggleCompetitors() {
            if (!map || !competitorsLayer) {
                console.log('Map or competitors layer not initialized');
                return;
            }
            
            const toggleBtn = document.getElementById('competitorToggle');
            const legend = document.getElementById('competitorsLegend');
            
            if (competitorsVisible) {
                // Hide competitors
                map.removeLayer(competitorsLayer);
                toggleBtn.textContent = 'Show Competitors';
                toggleBtn.classList.remove('active');
                legend.style.display = 'none';
                competitorsVisible = false;
            } else {
                // Show competitors  
                map.addLayer(competitorsLayer);
                toggleBtn.textContent = 'Hide Competitors';
                toggleBtn.classList.add('active');
                legend.style.display = 'block';
                competitorsVisible = true;
            }
        }
        
        function initializeGpkgLayer() {
            if (!gpkgData || !gpkgData.features || gpkgData.features.length === 0) {
                console.log('No GPKG data available');
                document.getElementById('gpkgToggle').style.display = 'none';
                return;
            }
            
            console.log(`Loading ${gpkgData.features.length} GPKG features`);
            
            // Create GPKG layer
            gpkgLayer = L.geoJSON(gpkgData, {
                style: function (feature) {
                    return {
                        fillColor: '#059669',
                        weight: 2,
                        opacity: 0.8,
                        color: '#047857',
                        fillOpacity: 0.2
                    };
                },
                onEachFeature: function (feature, layer) {
                    if (feature.properties) {
                        let popupContent = '<div style="font-size: 12px;"><strong>üéØ Catchment Area</strong><br>';
                        
                        // Add feature properties to popup
                        Object.keys(feature.properties).forEach(key => {
                            const value = feature.properties[key];
                            if (value !== null && value !== '') {
                                popupContent += `<strong>${key}:</strong> ${value}<br>`;
                            }
                        });
                        
                        popupContent += '</div>';
                        layer.bindPopup(popupContent);
                    }
                }
            });
        }
        
        function toggleGpkgLayer() {
            if (!map || !gpkgLayer) {
                console.log('Map or GPKG layer not initialized');
                return;
            }
            
            const toggleBtn = document.getElementById('gpkgToggle');
            
            if (gpkgVisible) {
                // Hide GPKG layer
                map.removeLayer(gpkgLayer);
                toggleBtn.textContent = 'Show Catchments';
                toggleBtn.classList.remove('active');
                gpkgVisible = false;
            } else {
                // Show GPKG layer
                map.addLayer(gpkgLayer);
                toggleBtn.textContent = 'Hide Catchments';
                toggleBtn.classList.add('active');
                gpkgVisible = true;
            }
        }
        
        window.updateLocation = updateLocation;
        window.changeFilterType = changeFilterType;
        window.showTab = showTab;
        window.switchMapLayer = switchMapLayer;
        window.toggleCompetitors = toggleCompetitors;
        window.toggleGpkgLayer = toggleGpkgLayer;
    </script>
</body>
</html>